<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="余声-个人博客">
<meta property="og:url" content="https://xiaoyaofeihu.github.io/page/5/index.html">
<meta property="og:site_name" content="余声-个人博客">
<meta property="og:locale">
<meta property="article:author" content="javayun">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '余声'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://xiaoyaofeihu.github.io/page/5/"/>





  <title>余声-个人博客</title>
  














<meta name="generator" content="Hexo 6.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">余声-个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/17/Linux/Linux%E4%B8%AD%E6%96%AD%E6%9C%BA%E5%88%B6%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/17/Linux/Linux%E4%B8%AD%E6%96%AD%E6%9C%BA%E5%88%B6%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/" itemprop="url">👌Linux中断机制是什么？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-17T13:33:41+00:00">
                2025-04-17
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌Linux中断机制是什么？"><a href="#👌Linux中断机制是什么？" class="headerlink" title="👌Linux中断机制是什么？"></a>👌Linux中断机制是什么？</h1><p>Linux中断机制是操作系统处理硬件和软件事件的一种重要方式。中断可以使操作系统及时响应各种事件，如硬件设备的输入输出操作、定时器事件等。</p>
<h3 id="中断的基本概念"><a href="#中断的基本概念" class="headerlink" title="中断的基本概念"></a>中断的基本概念</h3><h4 id="1-中断类型"><a href="#1-中断类型" class="headerlink" title="1.中断类型"></a>1.<strong>中断类型</strong></h4><ul>
<li><strong>硬件中断</strong>：由硬件设备（如键盘、网卡、硬盘等）发出的信号，引起CPU中断当前执行的程序，转而执行中断处理程序。</li>
<li><strong>软件中断</strong>：由软件指令（如系统调用、异常等）引发的中断。</li>
</ul>
<h4 id="2-中断向量表"><a href="#2-中断向量表" class="headerlink" title="2.中断向量表"></a>2.<strong>中断向量表</strong></h4><p>中断向量表（Interrupt Vector Table, IVT）是一个包含中断服务程序地址的表。当中断发生时，CPU通过中断向量表找到相应的中断服务程序并执行。</p>
<h3 id="中断处理流程"><a href="#中断处理流程" class="headerlink" title="中断处理流程"></a>中断处理流程</h3><ol>
<li><strong>中断发生</strong>：硬件设备或软件事件发出中断信号。</li>
<li><strong>中断响应</strong>：CPU停止当前执行的程序，保存当前的上下文（如程序计数器、寄存器等），并根据中断向量表找到对应的中断服务程序。</li>
<li><strong>中断处理</strong>：执行中断服务程序，处理中断事件。</li>
<li><strong>中断返回</strong>：中断处理完成后，恢复保存的上下文，继续执行被中断的程序。</li>
</ol>
<h3 id="中断处理的关键组件"><a href="#中断处理的关键组件" class="headerlink" title="中断处理的关键组件"></a>中断处理的关键组件</h3><h4 id="1-中断控制器"><a href="#1-中断控制器" class="headerlink" title="1.中断控制器"></a>1.<strong>中断控制器</strong></h4><p>中断控制器（如PIC、APIC）负责管理和分配中断请求。它可以屏蔽不需要的中断，并确定中断的优先级。</p>
<h4 id="2-中断处理程序"><a href="#2-中断处理程序" class="headerlink" title="2.中断处理程序"></a>2.<strong>中断处理程序</strong></h4><p>中断处理程序（Interrupt Service Routine, ISR）是处理特定中断事件的函数。它通常分为顶半部（Top Half）和底半部（Bottom Half）：</p>
<ul>
<li><strong>顶半部</strong>：快速响应中断，执行紧急的处理任务。</li>
<li><strong>底半部</strong>：延迟执行较长时间的任务，以减少顶半部的执行时间，避免阻塞其他中断。</li>
</ul>
<h4 id="3-中断上下文"><a href="#3-中断上下文" class="headerlink" title="3.中断上下文"></a>3.<strong>中断上下文</strong></h4><p>中断上下文是指中断发生时CPU的状态，包括程序计数器、寄存器等。保存和恢复中断上下文是中断处理的关键步骤。</p>
<h3 id="中断处理的实现"><a href="#中断处理的实现" class="headerlink" title="中断处理的实现"></a>中断处理的实现</h3><h4 id="1-注册中断处理程序"><a href="#1-注册中断处理程序" class="headerlink" title="1.注册中断处理程序"></a>1.<strong>注册中断处理程序</strong></h4><p>在Linux内核中，可以使用<code>request_irq</code>函数注册中断处理程序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;linux/interrupt.h&gt;</span><br><span class="line"></span><br><span class="line">int request_irq(unsigned int irq, irq_handler_t handler, unsigned long flags, const char *name, void *dev);</span><br></pre></td></tr></table></figure>

<h4 id="2-中断处理程序示例"><a href="#2-中断处理程序示例" class="headerlink" title="2.中断处理程序示例"></a>2.<strong>中断处理程序示例</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;linux/module.h&gt;</span><br><span class="line">#include &lt;linux/kernel.h&gt;</span><br><span class="line">#include &lt;linux/interrupt.h&gt;</span><br><span class="line"></span><br><span class="line">static irqreturn_t my_interrupt_handler(int irq, void *dev_id) &#123;</span><br><span class="line">    printk(KERN_INFO &quot;Interrupt occurred!\n&quot;);</span><br><span class="line">    // 中断处理逻辑</span><br><span class="line">    return IRQ_HANDLED;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static int __init my_module_init(void) &#123;</span><br><span class="line">    int irq = 1; // 假设中断号为1</span><br><span class="line">    int result = request_irq(irq, my_interrupt_handler, IRQF_SHARED, &quot;my_interrupt&quot;, NULL);</span><br><span class="line">    if (result) &#123;</span><br><span class="line">        printk(KERN_ERR &quot;Failed to request IRQ\n&quot;);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static void __exit my_module_exit(void) &#123;</span><br><span class="line">    int irq = 1; // 假设中断号为1</span><br><span class="line">    free_irq(irq, NULL);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(my_module_init);</span><br><span class="line">module_exit(my_module_exit);</span><br><span class="line"></span><br><span class="line">MODULE_LICENSE(&quot;GPL&quot;);</span><br><span class="line">MODULE_DESCRIPTION(&quot;A simple interrupt handler module&quot;);</span><br><span class="line">MODULE_AUTHOR(&quot;Your Name&quot;);</span><br></pre></td></tr></table></figure>

<h4 id="3-顶半部和底半部"><a href="#3-顶半部和底半部" class="headerlink" title="3.顶半部和底半部"></a>3.<strong>顶半部和底半部</strong></h4><ul>
<li><strong>顶半部</strong>：快速处理中断的关键部分。</li>
<li><strong>底半部</strong>：使用任务队列、工作队列或软中断机制延迟处理较长时间的任务。</li>
</ul>
<h3 id="中断的优先级和屏蔽"><a href="#中断的优先级和屏蔽" class="headerlink" title="中断的优先级和屏蔽"></a>中断的优先级和屏蔽</h3><p>中断控制器可以设置中断的优先级和屏蔽某些中断，以确保重要的中断优先得到处理。APIC（Advanced Programmable Interrupt Controller）提供了更高级的中断管理功能，如多级中断优先级和分布式中断处理。</p>
<h3 id="中断的嵌套和重入"><a href="#中断的嵌套和重入" class="headerlink" title="中断的嵌套和重入"></a>中断的嵌套和重入</h3><p>中断处理程序应尽量短小精悍，以减少中断嵌套的层数。中断处理程序应避免使用可能导致阻塞的操作，如长时间的I&#x2F;O操作和锁定操作。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/16/Linux/Linux%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E7%A3%81%E7%9B%98%E5%8D%A0%E7%94%A8%E6%83%85%E5%86%B5%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/16/Linux/Linux%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E7%A3%81%E7%9B%98%E5%8D%A0%E7%94%A8%E6%83%85%E5%86%B5%EF%BC%9F/" itemprop="url">👌Linux查看文件磁盘占用情况？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-16T13:33:41+00:00">
                2025-04-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌Linux查看文件磁盘占用情况？"><a href="#👌Linux查看文件磁盘占用情况？" class="headerlink" title="👌Linux查看文件磁盘占用情况？"></a>👌Linux查看文件磁盘占用情况？</h1><h3 id="1-du命令"><a href="#1-du命令" class="headerlink" title="1.du命令"></a>1.<code>du</code>命令</h3><p><code>du</code>（disk usage）命令用于估算文件和目录的磁盘使用情况。</p>
<h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du [选项] [文件或目录]</span><br></pre></td></tr></table></figure>

<h4 id="常用选项"><a href="#常用选项" class="headerlink" title="常用选项"></a>常用选项</h4><ul>
<li><code>-h</code>：以人类可读的格式显示（例如，K、M、G）。</li>
<li><code>-s</code>：显示总计（不显示子目录的详细信息）。</li>
<li><code>-a</code>：包括所有文件和目录。</li>
<li><code>-c</code>：显示总计。</li>
<li><code>--max-depth=N</code>：限制显示的目录层级深度。</li>
</ul>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><ul>
<li>查看当前目录下每个文件和子目录的磁盘使用情况：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du -h</span><br></pre></td></tr></table></figure>

<ul>
<li>查看指定目录的总磁盘使用情况：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du -sh /path/to/directory</span><br></pre></td></tr></table></figure>

<ul>
<li>查看指定目录及其子目录的磁盘使用情况，限制深度为1：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du -h --max-depth=1 /path/to/directory</span><br></pre></td></tr></table></figure>

<h3 id="2-df命令"><a href="#2-df命令" class="headerlink" title="2.df命令"></a>2.<code>df</code>命令</h3><p><code>df</code>（disk free）命令用于查看文件系统的磁盘使用情况。</p>
<h4 id="基本用法-1"><a href="#基本用法-1" class="headerlink" title="基本用法"></a>基本用法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df [选项] [文件或目录]</span><br></pre></td></tr></table></figure>

<h4 id="常用选项-1"><a href="#常用选项-1" class="headerlink" title="常用选项"></a>常用选项</h4><ul>
<li><code>-h</code>：以人类可读的格式显示（例如，K、M、G）。</li>
<li><code>-T</code>：显示文件系统类型。</li>
<li><code>-i</code>：显示inode使用情况。</li>
</ul>
<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><ul>
<li>查看所有挂载的文件系统的磁盘使用情况：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df -h</span><br></pre></td></tr></table></figure>

<ul>
<li>查看特定目录所在的文件系统的磁盘使用情况：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df -h /path/to/directory</span><br></pre></td></tr></table></figure>

<h3 id="3-ncdu工具"><a href="#3-ncdu工具" class="headerlink" title="3.ncdu工具"></a>3.<code>ncdu</code>工具</h3><p><code>ncdu</code>（NCurses Disk Usage）是一个基于ncurses的磁盘使用分析工具，提供了交互式界面。</p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>在Debian&#x2F;Ubuntu系统上：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ncdu</span><br></pre></td></tr></table></figure>

<p>在CentOS&#x2F;RHEL系统上：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install ncdu</span><br></pre></td></tr></table></figure>

<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ncdu /path/to/directory</span><br></pre></td></tr></table></figure>

<h3 id="4-ls命令"><a href="#4-ls命令" class="headerlink" title="4.ls命令"></a>4.<code>ls</code>命令</h3><p><code>ls</code>命令也可以显示文件的大小，但不如<code>du</code>详细。</p>
<h4 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h4><ul>
<li>以人类可读的格式显示文件大小：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -lh</span><br></pre></td></tr></table></figure>

<ul>
<li>显示目录的总大小：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -lhS</span><br></pre></td></tr></table></figure>

<h3 id="5-find命令结合du"><a href="#5-find命令结合du" class="headerlink" title="5.find命令结合du"></a>5.<code>find</code>命令结合<code>du</code></h3><p>可以使用<code>find</code>命令查找特定条件的文件，然后结合<code>du</code>命令查看它们的磁盘使用情况。</p>
<h4 id="示例-3"><a href="#示例-3" class="headerlink" title="示例"></a>示例</h4><ul>
<li>查找大于100MB的文件并显示其磁盘使用情况：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/directory -type f -size +100M -execdu -h &#123;&#125; +</span><br></pre></td></tr></table></figure>



<blockquote>
<p>原文: <a target="_blank" rel="noopener" href="https://www.yuque.com/jingdianjichi/xyxdsi/bnus9ng4m4oydmlu">https://www.yuque.com/jingdianjichi/xyxdsi/bnus9ng4m4oydmlu</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/16/Linux/Linux%E6%AD%BB%E9%94%81%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/16/Linux/Linux%E6%AD%BB%E9%94%81%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/" itemprop="url">👌Linux死锁是什么？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-16T13:33:41+00:00">
                2025-04-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌Linux死锁是什么？"><a href="#👌Linux死锁是什么？" class="headerlink" title="👌Linux死锁是什么？"></a>👌Linux死锁是什么？</h1><p>在Linux操作系统中，死锁（Deadlock）是指两个或多个进程在等待彼此释放资源，从而导致它们都无法继续执行的情况。这是一种常见的并发问题，尤其在多线程或多进程环境中。</p>
<h3 id="死锁的四个必要条件"><a href="#死锁的四个必要条件" class="headerlink" title="死锁的四个必要条件"></a>死锁的四个必要条件</h3><p>死锁的发生需要满足以下四个条件（也称为Coffman条件）：</p>
<ol>
<li><strong>互斥条件（Mutual Exclusion）</strong>：至少有一个资源是非共享的，即一次只能被一个进程使用。</li>
<li><strong>占有并等待条件（Hold and Wait）</strong>：一个进程已经持有了至少一个资源，并且正在等待获取其他被其他进程持有的资源。</li>
<li><strong>不剥夺条件（No Preemption）</strong>：资源不能被强制从进程中剥夺，只有持有资源的进程可以主动释放资源。</li>
<li><strong>环路等待条件（Circular Wait）</strong>：存在一个进程链，使得每个进程都在等待链中下一个进程所持有的资源。</li>
</ol>
<h3 id="死锁的检测和预防"><a href="#死锁的检测和预防" class="headerlink" title="死锁的检测和预防"></a>死锁的检测和预防</h3><p>为了处理死锁问题，可以采取以下几种策略：</p>
<h4 id="1-预防死锁"><a href="#1-预防死锁" class="headerlink" title="1.预防死锁"></a>1.<strong>预防死锁</strong></h4><p>预防死锁的方法包括破坏上述四个条件之一：</p>
<ul>
<li><strong>破坏互斥条件</strong>：尽可能减少对非共享资源的使用。</li>
<li><strong>破坏占有并等待条件</strong>：在进程开始时一次性分配所有需要的资源，或者要求进程在请求资源前释放所有持有的资源。</li>
<li><strong>破坏不剥夺条件</strong>：允许操作系统强制剥夺某些资源。</li>
<li><strong>破坏环路等待条件</strong>：对资源进行排序，并要求进程按顺序请求资源。</li>
</ul>
<h4 id="2-避免死锁"><a href="#2-避免死锁" class="headerlink" title="2.避免死锁"></a>2.<strong>避免死锁</strong></h4><p>避免死锁的方法主要是通过资源分配策略来确保系统永远不会进入死锁状态。常用的方法包括银行家算法（Banker’s Algorithm），它通过模拟资源分配情况来判断是否会导致死锁。</p>
<h4 id="3-检测和恢复"><a href="#3-检测和恢复" class="headerlink" title="3.检测和恢复"></a>3.<strong>检测和恢复</strong></h4><p>如果无法预防或避免死锁，可以通过检测和恢复来处理死锁：</p>
<ul>
<li><strong>死锁检测</strong>：定期检查系统中是否存在死锁。可以使用资源分配图（Resource Allocation Graph）来检测环路，从而识别死锁。</li>
<li><strong>死锁恢复</strong>：一旦检测到死锁，可以通过以下方式恢复：<ul>
<li><strong>终止进程</strong>：强制终止一个或多个进程以打破死锁。</li>
<li><strong>资源剥夺</strong>：强制从某些进程中剥夺资源并重新分配。</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/16/Linux/linux%E5%86%85%E5%AD%98%E6%9C%89%E9%97%AE%E9%A2%98%E6%80%8E%E4%B9%88%E6%9F%A5%E7%9C%8B%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/16/Linux/linux%E5%86%85%E5%AD%98%E6%9C%89%E9%97%AE%E9%A2%98%E6%80%8E%E4%B9%88%E6%9F%A5%E7%9C%8B%EF%BC%9F/" itemprop="url">👌Linux内存有问题怎么查看？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-16T13:33:41+00:00">
                2025-04-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌linux-内存有问题怎么查看？"><a href="#👌linux-内存有问题怎么查看？" class="headerlink" title="👌linux 内存有问题怎么查看？"></a>👌linux 内存有问题怎么查看？</h1><p>如果怀疑内存有问题，可以通过以下步骤进行检查和诊断：</p>
<h3 id="1-使用free命令查看内存使用情况"><a href="#1-使用free命令查看内存使用情况" class="headerlink" title="1. 使用free命令查看内存使用情况"></a>1. 使用<code>free</code>命令查看内存使用情况</h3><p><code>free</code>命令可以显示系统的内存使用情况，包括总内存、已使用内存、空闲内存和缓存等信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -h</span><br></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           7.8G        3.2G        1.5G        200M        3.1G        4.1G</span><br><span class="line">Swap:          2.0G        0.0K        2.0G</span><br></pre></td></tr></table></figure>

<h3 id="2-使用top或htop命令查看内存使用情况"><a href="#2-使用top或htop命令查看内存使用情况" class="headerlink" title="2. 使用top或htop命令查看内存使用情况"></a>2. 使用<code>top</code>或<code>htop</code>命令查看内存使用情况</h3><p><code>top</code>和<code>htop</code>命令可以实时显示系统的资源使用情况，包括内存使用情况。</p>
<ul>
<li><code>top</code>命令：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>

<ul>
<li><code>htop</code>命令（需要安装）：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install htop</span><br><span class="line">htop</span><br></pre></td></tr></table></figure>

<h3 id="3-使用vmstat命令查看内存和系统性能"><a href="#3-使用vmstat命令查看内存和系统性能" class="headerlink" title="3. 使用vmstat命令查看内存和系统性能"></a>3. 使用<code>vmstat</code>命令查看内存和系统性能</h3><p><code>vmstat</code>命令可以报告虚拟内存、进程、CPU 活动等信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat 1 5</span><br></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st</span><br><span class="line"> 1  0      0 1576828  72464 2192160    0    0     8    11   64  150  1  0 99  0  0</span><br><span class="line"> 0  0      0 1576820  72464 2192160    0    0     0     0   59  144  0  0 100  0  0</span><br></pre></td></tr></table></figure>

<h3 id="4-检查内存使用情况的日志"><a href="#4-检查内存使用情况的日志" class="headerlink" title="4. 检查内存使用情况的日志"></a>4. 检查内存使用情况的日志</h3><p>查看系统日志，如<code>/var/log/syslog</code>或<code>/var/log/messages</code>，看看是否有与内存相关的错误或警告。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo grep -i memory /var/log/syslog</span><br><span class="line">sudo grep -i memory /var/log/messages</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/16/Linux/linux%E7%9A%84%E4%B8%AD%E6%96%AD%E6%9C%BA%E5%88%B6%E7%94%A8%E6%9D%A5%E5%B9%B2%E4%BB%80%E4%B9%88%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/16/Linux/linux%E7%9A%84%E4%B8%AD%E6%96%AD%E6%9C%BA%E5%88%B6%E7%94%A8%E6%9D%A5%E5%B9%B2%E4%BB%80%E4%B9%88%EF%BC%9F/" itemprop="url">👌linux的中断机制用来干什么？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-16T13:33:41+00:00">
                2025-04-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌linux的中断机制用来干什么？"><a href="#👌linux的中断机制用来干什么？" class="headerlink" title="👌linux的中断机制用来干什么？"></a>👌linux的中断机制用来干什么？</h1><p>Linux的中断机制用于处理各种硬件和软件事件，使操作系统能够及时响应并处理这些事件。中断机制在操作系统中起着至关重要的作用。</p>
<h3 id="1-硬件设备的事件处理"><a href="#1-硬件设备的事件处理" class="headerlink" title="1.硬件设备的事件处理"></a>1.<strong>硬件设备的事件处理</strong></h3><p>硬件设备通过中断机制通知操作系统它们的状态变化或需要处理的事件。例如：</p>
<ul>
<li><strong>键盘输入</strong>：当键盘按键被按下时，键盘控制器会发出中断信号，通知CPU读取按键值。</li>
<li><strong>网络数据接收</strong>：网卡接收到数据包时，会触发中断，通知操作系统处理接收到的数据。</li>
<li><strong>硬盘I&#x2F;O完成</strong>：硬盘完成读写操作后，会发出中断信号，通知操作系统该操作已完成，可以继续处理数据。</li>
</ul>
<h3 id="2-定时器和时钟管理"><a href="#2-定时器和时钟管理" class="headerlink" title="2.定时器和时钟管理"></a>2.<strong>定时器和时钟管理</strong></h3><p>操作系统使用定时器中断来管理系统时钟和时间片轮转。例如：</p>
<ul>
<li><strong>系统时钟更新</strong>：定时器会定期触发中断，操作系统通过这些中断更新系统时钟。</li>
<li><strong>时间片轮转</strong>：在多任务操作系统中，定时器中断用于实现时间片轮转调度，确保各个进程能够公平地获得CPU时间。</li>
</ul>
<h3 id="3-系统调用和异常处理"><a href="#3-系统调用和异常处理" class="headerlink" title="3.系统调用和异常处理"></a>3.<strong>系统调用和异常处理</strong></h3><p>软件中断（如系统调用和异常）允许用户空间程序与内核进行交互，并处理异常情况。例如：</p>
<ul>
<li><strong>系统调用</strong>：用户程序通过触发软件中断进入内核态，执行系统调用以请求操作系统服务（如文件操作、进程管理等）。</li>
<li><strong>异常处理</strong>：当程序发生异常（如除零错误、非法内存访问等）时，CPU会触发异常中断，操作系统捕获并处理这些异常。</li>
</ul>
<h3 id="4-中断驱动的I-x2F-O操作"><a href="#4-中断驱动的I-x2F-O操作" class="headerlink" title="4.中断驱动的I&#x2F;O操作"></a>4.<strong>中断驱动的I&#x2F;O操作</strong></h3><p>中断机制使得设备驱动程序可以实现高效的I&#x2F;O操作。例如：</p>
<ul>
<li><strong>非阻塞I&#x2F;O</strong>：通过中断通知，设备驱动程序可以在设备准备好时处理I&#x2F;O操作，而无需进程持续轮询设备状态，从而提高系统效率。</li>
</ul>
<h3 id="5-电源管理"><a href="#5-电源管理" class="headerlink" title="5.电源管理"></a>5.<strong>电源管理</strong></h3><p>中断机制在电源管理中也扮演重要角色。例如：</p>
<ul>
<li><strong>电池状态变化</strong>：当电池电量低或充电完成时，电源管理芯片会触发中断，通知操作系统采取相应的措施（如节能模式或提示用户）。</li>
</ul>
<h3 id="6-多核处理器的中断分配"><a href="#6-多核处理器的中断分配" class="headerlink" title="6.多核处理器的中断分配"></a>6.<strong>多核处理器的中断分配</strong></h3><p>在多核处理器系统中，中断控制器（如APIC）可以将中断分配到不同的CPU核，以实现负载均衡和提高并行处理能力。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/16/JVM/%E5%B8%B8%E8%A7%81%E7%9A%84jvm%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/16/JVM/%E5%B8%B8%E8%A7%81%E7%9A%84jvm%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%EF%BC%9F/" itemprop="url">👌常见的jvm垃圾收集器的工作流程？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-16T13:33:41+00:00">
                2025-04-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌常见的jvm垃圾收集器的工作流程？"><a href="#👌常见的jvm垃圾收集器的工作流程？" class="headerlink" title="👌常见的jvm垃圾收集器的工作流程？"></a>👌常见的jvm垃圾收集器的工作流程？</h1><h1 id="题目详细答案"><a href="#题目详细答案" class="headerlink" title="题目详细答案"></a>题目详细答案</h1><h2 id="Serial"><a href="#Serial" class="headerlink" title="Serial"></a>Serial</h2><p>Serial 垃圾收集过程的简单之处在于其采用了单线程执行的方式，以简化实现并减少资源占用。</p>
<ol>
<li>暂停用户线程（Stop the World）：</li>
</ol>
<p>在开始垃圾收集过程之前，Serial 垃圾收集器会暂停（停止）所有的用户线程。这是为了确保在垃圾收集过程中对象的状态不会被修改，从而保证垃圾收集的准确性。</p>
<ol start="2">
<li>执行垃圾收集：</li>
</ol>
<p>一旦用户线程暂停，Serial 垃圾收集器会开启一个单线程来执行垃圾回收操作。这个线程会遍历堆中的对象，标记并清理不再使用的对象，以释放内存空间。</p>
<ol start="3">
<li>等待垃圾收集完成：</li>
</ol>
<p>在垃圾收集过程中，用户线程会被暂停，直到垃圾收集完毕。这意味着用户线程无法在垃圾收集期间执行任何操作。</p>
<p>当垃圾收集完成后，Serial 垃圾收集器会恢复用户线程的执行。此时，垃圾已被清理，堆内存中有更多的可用空间供应用程序使用。</p>
<h2 id="Parallel-Scavenge-和-Parallel-Old"><a href="#Parallel-Scavenge-和-Parallel-Old" class="headerlink" title="Parallel Scavenge 和 Parallel Old"></a>Parallel Scavenge 和 Parallel Old</h2><p>Parallel Scavenge 和 Parallel Old 是 Parallel 收集器系列的两个组成部分，它们的工作机制相似，都是利用多线程并行执行垃圾回收操作，以提高整个垃圾收集过程的效率和吞吐量。以 Parallel Scavenge 为例来说明其工作机制：</p>
<ol>
<li>多线程并行执行：Parallel Scavenge 收集器利用了多个线程并行执行新生代的垃圾回收操作。这意味着在进行新生代垃圾回收时，多个线程同时工作，加快了垃圾收集的速度。</li>
<li>暂停用户线程：与 Serial 收集器类似，Parallel Scavenge 在进行垃圾收集时会暂停用户线程，以确保垃圾回收的准确性。这一阶段通常称为“Stop the World”。</li>
<li>多线程并发清理：Parallel Scavenge 收集器的特点之一是在新生代垃圾收集过程中采用并发清理的方式。这意味着在暂停用户线程期间，多个线程同时清理新生代中的垃圾对象，从而更快地完成垃圾收集过程。</li>
</ol>
<p>通过利用多个线程并行执行垃圾收集操作，Parallel Scavenge 能够充分发挥多核 CPU 的优势，提高了垃圾收集的效率。相比于 Serial 收集器，它能更快地完成垃圾回收操作，从而减少了应用程序的停顿时间，从而提高了整个应用程序的性能。</p>
<h2 id="ParNew-和-Parallel-Scavenge"><a href="#ParNew-和-Parallel-Scavenge" class="headerlink" title="ParNew 和 Parallel Scavenge"></a>ParNew 和 Parallel Scavenge</h2><p>ParNew 收集器和 Parallel Scavenge 收集器在工作流程上确实非常相似，都是并行垃圾收集器。</p>
<p><font style="color:rgb(36, 41, 47);">1、 标记阶段</font></p>
<p><font style="color:rgb(36, 41, 47);">在垃圾收集开始时，ParNew 收集器会暂停所有应用线程（Stop-The-World），然后开始标记所有存活的对象。标记阶段的主要任务是识别哪些对象是存活的，并将它们标记出来。</font></p>
<p><font style="color:rgb(36, 41, 47);">2、 复制阶段</font></p>
<p><font style="color:rgb(36, 41, 47);">在标记阶段完成之后，ParNew 收集器会将所有存活的对象从 Eden 区和一个 Survivor 区（例如 S0）复制到另一个 Survivor 区（例如 S1）。如果目标 Survivor 区没有足够的空间容纳所有存活对象，存活对象将被移动到老年代。</font></p>
<p><font style="color:rgb(36, 41, 47);">3、 清理阶段</font></p>
<p><font style="color:rgb(36, 41, 47);">复制阶段完成后，Eden 区和之前的 Survivor 区（例如 S0）中的所有对象都被认为是垃圾，并且这些区域的内存可以被清理和重用。</font></p>
<p><font style="color:rgb(36, 41, 47);">4、 应用程序恢复</font></p>
<p><font style="color:rgb(36, 41, 47);">在清理阶段完成之后，应用程序线程将被重新启动，继续执行。</font></p>
<p>ParNew 收集器的工作流程与 Parallel Scavenge 收集器类似，都是通过停止应用程序线程，然后利用多线程并行执行垃圾回收操作，最后恢复用户线程的执行。这种并行执行的方式能够提高垃圾收集的效率，同时在暂停用户线程期间确保垃圾收集的准确性。</p>
<h2 id="CMS"><a href="#CMS" class="headerlink" title="CMS"></a>CMS</h2><p>CMS垃圾收集器为了尽量减少用户线程的停顿时间，采用了一种创新的策略。这一策略使得在垃圾回收过程的某些阶段，用户线程和垃圾回收线程可以共同工作，从而避免了长时间的垃圾回收导致用户线程一直处于等待状态。</p>
<p>整个 CMS 垃圾收集过程被划分为四个阶段，它们分别是：</p>
<ol>
<li>初始标记：在这个阶段，CMS 垃圾收集器会对根对象进行一次快速的标记，标记出所有与根对象直接关联的存活对象。这个阶段需要暂停用户线程，因为要确保标记的准确性。</li>
<li>并发标记：在这个阶段，CMS 垃圾收集器会与用户线程并发执行，对整个堆进行标记。垃圾回收线程会在后台标记所有存活对象，而用户线程可以继续执行，不受影响。</li>
<li>重新标记：在并发标记阶段结束后，CMS 垃圾收集器会进行一次重新标记，来处理在并发标记阶段发生变化的对象。这个阶段需要暂停用户线程，以确保标记的准确性。</li>
<li>并发清理：在重新标记完成后，CMS 垃圾收集器会与用户线程并发执行，清理未标记的对象。垃圾回收线程会在后台清理不再使用的对象，而用户线程可以继续执行，不受影响。</li>
</ol>
<p>通过将垃圾回收过程分为多个阶段，并在其中允许用户线程和垃圾回收线程并发执行，CMS 垃圾收集器成功地减少了用户线程的停顿时间。这种创新的并发垃圾收集策略提高了系统的响应性和用户体验，确保了应用程序的顺畅运行。</p>
<h2 id="G1"><a href="#G1" class="headerlink" title="G1"></a>G1</h2><p>G1 垃圾收集器的回收流程与 CMS 的逻辑大致相同，包括初始标记、并发标记、重新标记和筛选清除等阶段。但是，与 CMS 不同的是，G1 在最后一个阶段不会直接进行整体的清除。相反，它会根据用户设置的停顿时间进行智能的筛选和局部的回收。</p>
<ol>
<li>初始标记：在初始标记阶段，G1 垃圾收集器会对根对象进行一次快速的标记，标记出所有与根对象直接关联的存活对象。这个阶段需要暂停用户线程，以确保标记的准确性。</li>
<li>并发标记：在并发标记阶段，G1 垃圾收集器会与用户线程并发执行，对整个堆进行标记。垃圾回收线程会在后台标记所有存活对象，而用户线程可以继续执行，不受影响。</li>
<li>重新标记：在并发标记阶段结束后，G1 垃圾收集器会进行一次重新标记，来处理在并发标记阶段发生变化的对象。这个阶段需要暂停用户线程，以确保标记的准确性。</li>
<li>筛选清除：在重新标记完成后，G1 垃圾收集器不会立即进行整体的清除操作。相反，它会根据用户设置的停顿时间智能地筛选出需要回收的 Region，并执行局部的回收。这样可以在尽量满足停顿时间的情况下，最大限度地回收垃圾。</li>
</ol>
<p>通过这种智能的筛选和局部回收方式，G1 垃圾收集器能够更好地平衡垃圾回收的效率和停顿时间，从而提高系统的响应性和用户体验。</p>
<h2 id="ZGC"><a href="#ZGC" class="headerlink" title="ZGC"></a>ZGC</h2><p>ZGC 的垃圾回收过程几乎全部都是并发执行的，即与应用程序线程同时进行。</p>
<ol>
<li>初始标记（Initial Mark）：在初始标记阶段，ZGC 会标记出根对象以及直接与根对象关联的存活对象。这个阶段需要短暂地暂停所有应用线程，以确保标记的准确性。</li>
<li>并发标记（Concurrent Mark）：在并发标记阶段，ZGC 与应用程序线程并发执行，标记所有存活对象。这个阶段不会暂停应用程序线程，因此垃圾回收和应用程序可以并发执行。</li>
<li>最终标记（Final Mark）：在并发标记阶段结束后，ZGC 需要再次短暂地暂停所有应用线程，完成最终的标记工作。这个阶段主要用于标记在并发标记阶段有可能发生变化的对象。</li>
<li>筛选（Concurrent Sweep）：在最终标记完成后，ZGC 会进行一次筛选，确定哪些对象可以被回收。这个阶段会并发地进行，不会暂停应用程序线程。</li>
<li>并发清除（Concurrent Cleanup）：在筛选阶段完成后，ZGC 会并发地清除未被标记的对象，释放它们所占用的内存。这个阶段也不会暂停应用程序线程。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/11/%E6%96%B9%E6%B3%95%E8%AE%BA/Mysql%E5%B8%B8%E7%94%A8%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/11/%E6%96%B9%E6%B3%95%E8%AE%BA/Mysql%E5%B8%B8%E7%94%A8%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87%EF%BC%9F/" itemprop="url">👌Mysql常用监控指标？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-11T13:33:41+00:00">
                2025-04-11
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">方法论</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌Mysql常用监控指标？"><a href="#👌Mysql常用监控指标？" class="headerlink" title="👌Mysql常用监控指标？"></a>👌Mysql常用监控指标？</h1><p>1、QPS：数据库每秒处理的请求数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status where variable_name in (&#x27;Queries&#x27;， &#x27;uptime&#x27;);</span><br></pre></td></tr></table></figure>

<p>QPS &#x3D; (Queries2 -Queries1) &#x2F; (uptime2 - uptime1)</p>
<p>2、TPS：数据库每秒处理的事务数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status where variable_name in (&#x27;com_insert&#x27; ， &#x27;com_delete&#x27; ， &#x27;com_update&#x27;， &#x27;uptime&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>事务数TC</strong> ≈’com_insert’ ， ‘com_delete’ ， ‘com_update’</p>
<p><strong>TPS</strong> ≈ (TC2 -TC1) &#x2F; (uptime2 - uptime1)</p>
<p>3、并发数：数据库实例当前并行处理的会话数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &#x27;Threads_running&#x27;;</span><br></pre></td></tr></table></figure>

<p>4、连接数：连接到数据库会话的数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &#x27;Threads_connected&#x27;;</span><br></pre></td></tr></table></figure>

<p>5、缓存命中率：查询命中缓存的比例</p>
<p><strong>innodb缓冲池查询总数：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &#x27;innodb_buffer_pool_read_requests&#x27;;</span><br></pre></td></tr></table></figure>

<p><strong>innodb从磁盘查询数：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &#x27;innodb_buffer_pool_reads&#x27;;</span><br></pre></td></tr></table></figure>

<p>生产中配置报警阈值：innodb_buffer_pool_read_requests &#x2F;(innodb_buffer_pool_read_requests + innodb_buffer_pool_reads) &gt; 0.95 </p>
<p>6、可用性：数据库是否可以正常对外服务</p>
<p>周期性连接数据库并执行 <strong>select @@version;</strong></p>
<p>7、阻塞：当前阻塞的会话数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select waiting_pid as &#x27;被阻塞线程&#x27;，</span><br><span class="line">    waiting_query as &#x27;被阻塞SQL&#x27;，</span><br><span class="line">     blocking_pid as &#x27;阻塞线程&#x27;，</span><br><span class="line">     blocking_query as &#x27;阻塞SQL&#x27;，</span><br><span class="line">     wait_age as &#x27;阻塞时间&#x27;，</span><br><span class="line">     sql_kill_blocking_query as &#x27;建议操作&#x27;</span><br><span class="line">from sys.innodb_lock_waits</span><br><span class="line">where(unix_timestamp()-unix_timestamp(wait_started))&gt;阻塞秒数</span><br></pre></td></tr></table></figure>

<p>8、慢查询：慢查询情况</p>
<p>开启慢查询日志<strong>。</strong>my.inf </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">slow_query_log=on</span><br><span class="line">slow_query_log_file=存放目录</span><br><span class="line">long_query_time=0.1秒</span><br><span class="line">log_queries_not_using_indexes=on</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/11/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E5%86%99%E5%A5%BD%E4%BB%A3%E7%A0%81%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/11/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E5%86%99%E5%A5%BD%E4%BB%A3%E7%A0%81%EF%BC%9F/" itemprop="url">👌如何写好代码？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-11T13:33:41+00:00">
                2025-04-11
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">方法论</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌如何写好代码？"><a href="#👌如何写好代码？" class="headerlink" title="👌如何写好代码？"></a>👌如何写好代码？</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>从代码的角度来说，好的代码可以提高系统的可维护性，扩展性。坏的代码会导致系统后期的维护和复杂性都变得非常高，非常混乱。全是坏代码的话，如果不重构就是，一坨屎山。如果重构的话，重构的人，就要💩上雕花。这是很难受的。下面是鸡哥觉得一个好代码要注意的点，大家理解吸收之后和面试官吹就好了。</p>
<h1 id="代码整洁、可读"><a href="#代码整洁、可读" class="headerlink" title="代码整洁、可读"></a>代码整洁、可读</h1><p>这个是必须的，代码工整，好理解，不要为了秀技，写一堆复杂的代码。而且代码之间的逻辑一定要清晰，不要大段大段的写，一屏幕一屏幕的写，没意义。需要划分模块，规定方法，单一职责，各司其职。</p>
<p>重复的代码会极大的增加后续的维护成本，也容易造成修改的遗漏。一定要对重复代码进行抽象和处理。</p>
<h1 id="遵循规范"><a href="#遵循规范" class="headerlink" title="遵循规范"></a>遵循规范</h1><p>遵循项目风格的规范，不要搞特殊，每个项目历史背景不同，时间不同，风格都不一样，大家一定要注意保持一致，不要增加本来熟悉这个项目的人的理解成本。</p>
<p>还有就是团队内使用统一的代码格式，如缩进、空格和注释风格。</p>
<h1 id="模块化设计"><a href="#模块化设计" class="headerlink" title="模块化设计"></a>模块化设计</h1><p>开闭原则和单一原则、模块化。要重点考虑。这样当一个需求发生的时候，其他人修改代码也是十分放心的。只需要关注自己修改的地方，而不需要考虑更多的逻辑。</p>
<p>模块间的依赖尽量少，各自搞各自的。不要强耦合。</p>
<p>单一职责就是一个方法，类最好只干一件事，这样的理解成本非常低。</p>
<h1 id="注释"><a href="#注释" class="headerlink" title="注释"></a><font style="color:rgb(36, 41, 47);">注释</font></h1><p>其实说过好多遍，一定要写，复杂的逻辑，注释更加易于理解。但是不要写成流水账，而是描述代码的意图。</p>
<h1 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a><font style="color:rgb(36, 41, 47);">单元测试</font></h1><p>确保关键功能都有对应的单元测试，覆盖常见的和边界的用例，使用持续集成工具自动运行测试，确保每次代码变更都不会破坏已有功能。</p>
<h1 id="持续重构"><a href="#持续重构" class="headerlink" title="持续重构"></a><font style="color:rgb(36, 41, 47);">持续重构</font></h1><p>在开发过程中定期进行代码重构，改善代码结构和质量，每次重构的改动应尽量小且可控，确保系统的稳定性。</p>
<h1 id="鲁棒性"><a href="#鲁棒性" class="headerlink" title="鲁棒性"></a>鲁棒性</h1><p>鲁棒性表示系统可以在各种异常的情况下仍然可以稳定的工作，而不是出现不可预期的问题。好的代码在设计的时候就需要考虑各种异常和极端的场景应该如何处理，也就是常常说的面向失败和异常编程，多考虑失败场景如何处理。</p>
<h1 id="学习和使用设计模式"><a href="#学习和使用设计模式" class="headerlink" title="学习和使用设计模式"></a><font style="color:rgb(36, 41, 47);">学习和使用设计模式</font></h1><p>学习常见的设计模式并在适当的场景下应用，可以提高代码的可扩展性和可维护性。同时不过度使用设计模式，保持设计的简单和直接。</p>
<h1 id="代码评审"><a href="#代码评审" class="headerlink" title="代码评审"></a><font style="color:rgb(36, 41, 47);">代码评审</font></h1><p>通过代码评审发现潜在问题，分享知识，提高团队整体的代码质量。积极接受同事的反馈，持续改进自己的编码习惯和技巧。一定要多吸取别人建议。</p>
<h1 id="性能大关"><a href="#性能大关" class="headerlink" title="性能大关"></a><font style="color:rgb(36, 41, 47);">性能大关</font></h1><p>在开发过程中关注代码的性能，避免不必要的性能瓶颈。使用性能分析工具检测和优化代码中的性能问题。</p>
<p>通过遵循这些建议，可以显著提高代码的质量，使其更易于维护、扩展和理解。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/11/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E5%87%86%E5%A4%87%E9%A1%B9%E7%9B%AE%E5%8E%8B%E6%B5%8B%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/11/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E5%87%86%E5%A4%87%E9%A1%B9%E7%9B%AE%E5%8E%8B%E6%B5%8B%EF%BC%9F/" itemprop="url">👌如何准备项目压测？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-11T13:33:41+00:00">
                2025-04-11
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">方法论</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌如何准备项目压测？"><a href="#👌如何准备项目压测？" class="headerlink" title="👌如何准备项目压测？"></a>👌如何准备项目压测？</h1><p><font style="color:rgb(47, 48, 52);">一道开放题，年限高的会问到，初入茅庐的小伙伴会问。我不是开发吗。为什么问压测的问题！压测研发同样要配合很多东西。考察你的全局掌控能力。主要是要先梳理清楚几个方面。</font></p>
<h2 id="数据库层面梳理"><a href="#数据库层面梳理" class="headerlink" title="数据库层面梳理"></a><font style="color:rgb(47, 48, 52);">数据库层面梳理</font><font style="color:rgb(47, 48, 52);"></font></h2><p><font style="color:rgb(47, 48, 52);">数据库层面我们重点关注的是高可用，慢sql，预警，连接池，读写分离。</font></p>
<p><font style="color:rgb(47, 48, 52);">比如库名，数据库从库是否在两个以上，并且从库不在同一个机房，是否订阅慢SQL，数据库线程池是否配置合理，是否有考虑库存容量及增长情况，数据库是否做了读写分离等等。</font></p>
<h2 id="Redis层面"><a href="#Redis层面" class="headerlink" title="Redis层面"></a><font style="color:rgb(47, 48, 52);">Redis层面</font></h2><p><font style="color:rgb(47, 48, 52);">梳理集群，缓存主备是否双写，是否具备动态切换机制，是否考虑缓存容量及增长情况，是否配置缓存报警，是否有key未设置过期时间，是否存在热Key，是否存在大Key</font></p>
<h2 id="应用层面"><a href="#应用层面" class="headerlink" title="应用层面"></a><font style="color:rgb(47, 48, 52);">应用层面</font></h2><p>梳理<font style="color:rgb(47, 48, 52);">是否为双机房部署，JVM配置标准化检查，内存占用率排查，是否设置磁盘预警规则</font></p>
<h2 id="消息队列层面"><a href="#消息队列层面" class="headerlink" title="消息队列层面"></a><font style="color:rgb(47, 48, 52);">消息队列层面</font></h2><p><font style="color:rgb(47, 48, 52);">梳理TOPIC，队列类型，是否配置消息积压报警，是否开启消息归档</font></p>
<h2 id="外部依赖梳理"><a href="#外部依赖梳理" class="headerlink" title="外部依赖梳理"></a><font style="color:rgb(47, 48, 52);">外部依赖梳理</font></h2><p><font style="color:rgb(47, 48, 52);">作为前台的业务系统，主要是依赖中台的外部接口来进行业务逻辑处理，那么一定要梳理外部依赖的接口，别名，外部接口负责人，是否要提升限流值，限流后触发的现象，以及外部不可用是否有降级措施等等。</font></p>
<p><font style="color:rgb(47, 48, 52);">梳理依赖的外部接口，当前qps，预估qps ，紧急联系人</font></p>
<h2 id="资源梳理"><a href="#资源梳理" class="headerlink" title="资源梳理"></a><font style="color:rgb(47, 48, 52);">资源梳理</font><font style="color:rgb(47, 48, 52);"></font></h2><p><font style="color:rgb(47, 48, 52);">容器资源作为我们的基石，我们有必要去把每个服务占用的资源情况梳理清楚，同时判断在618期间是否要进行扩容，来扛住更多的量，分析机房之间的机器数量是否均衡，应该保证1:1的情况。不要造成流量的倾斜。对于一些大的应用，比如超过500核，我们也要认真评估其是否有必要。</font></p>
<p>梳理，<font style="color:rgb(47, 48, 52);">现有应用总容器数，促销活动总容器数，机房，分组，计划扩容数量等等</font></p>
<h2 id="应用接口梳理"><a href="#应用接口梳理" class="headerlink" title="应用接口梳理"></a><font style="color:rgb(47, 48, 52);">应用接口梳理</font></h2><p>梳理<font style="color:rgb(47, 48, 52);">功能模块，接口级别，场景描述，日常QPS(峰值)，日常调用量&#x2F;天，日常TP999，预估QPS，预估调用量，预估TP999，是否压测，负责人</font></p>
<h2 id="配合测试确定范围"><a href="#配合测试确定范围" class="headerlink" title="配合测试确定范围"></a>配合测试确定范围</h2><p>梳理清楚之后，就是和测试进行压测范围的圈定，确定接口和预计达到的巅峰。</p>
<h2 id="压测观察"><a href="#压测观察" class="headerlink" title="压测观察"></a>压测观察</h2><p>边压测的过程要边进行观察。如果有异常，或者恶劣影响，及时停止！</p>
<h2 id="压测复盘"><a href="#压测复盘" class="headerlink" title="压测复盘"></a>压测复盘</h2><p>复盘压测时不通过的接口，和性能瓶颈，下来进行优化。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/11/%E6%96%B9%E6%B3%95%E8%AE%BA/%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/11/%E6%96%B9%E6%B3%95%E8%AE%BA/%E7%BA%BF%E4%B8%8A%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E8%AE%BA/" itemprop="url">👌线上问题处理？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-11T13:33:41+00:00">
                2025-04-11
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">方法论</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌线上问题处理方法论"><a href="#👌线上问题处理方法论" class="headerlink" title="👌线上问题处理方法论"></a>👌线上问题处理方法论</h1><p>方法论都是精华，希望各位鸡友们，理解其中深邃之处。</p>
<p>当产生线上问题的时候，如果没有一套方法处理机制，很容易就陷入慌乱，思路不清晰，会导致损失越来越大，反馈越来越多，耗时越老越长。基于经验，可以沉淀出一些操作步骤。</p>
<h1 id="问题发生反馈"><a href="#问题发生反馈" class="headerlink" title="问题发生反馈"></a>问题发生反馈</h1><p>当收到问题发生反馈的时候，第一个思路！！！止损，止损，止损！可能工作经验少，或者没有工作经验的人体会不到。记住，不是去追究问题是什么原理发生的，问题是谁造成的，就一个目地，任何方案，快速止损，立马恢复系统。涉及金钱、损失之类的线上问题，立马向上升级，切忌闷头自己处理，不上报。老板们的资源比你多，经验多，说不定可以快速帮到你！</p>
<p>立马根据自己经验评估，是否非常熟悉，可快速解决，如果不可以，立马拉群，寻求其他小伙伴帮助！</p>
<p>在止损的过程中，尽可能保留线上的证据，比如日志、dump、异常流量情况 等等。方便后面复盘。</p>
<p>心态稳住，事情已经发生，我们在这个阶段要做的是解决问题，而不是思考之后会不会挨骂，等等等。心态要平和，专注到当前事件的解决上。</p>
<p>如果你是旁观者，或者来帮忙的，不要打扰主解决者的思路，问一些奇奇怪怪的，不了解情况的问题。</p>
<h1 id="问题定位思路"><a href="#问题定位思路" class="headerlink" title="问题定位思路"></a>问题定位思路</h1><p>收集问题产生现象，定位入口，定位日志，定位报错信息。</p>
<p>收集要保证尽可能的多汲取信息，不仅仅是日志，还可能是用户的表达，用户的操作行为，手机机型，网络等等。</p>
<p>第一反应：快速确认今天是否有上线操作影响。如果有立马切流量，或回滚。</p>
<p>开始观察日志分析，确认实际的报错信息。</p>
<p>观察报错后，依据自身经验开始排查，是否是调用量暴增，还是有明显的报错日志。抓取错误流量参数。服务器是否正常。</p>
<p>基于以上，联想问题点。</p>
<p>检查流量问题，服务调用异常问题，网络问题，服务器问题，数据库问题等等。</p>
<p>同时测试同学快速复现，看是否可以产生其他有价值的信息。</p>
<p><font style="color:rgb(47, 48, 52);">最终综合多信息找到异常点，定位故障。一定要不慌，保证准确的同时，迅速！</font></p>
<h1 id="问题后复盘"><a href="#问题后复盘" class="headerlink" title="问题后复盘"></a>问题后复盘</h1><p>评估影响级别，用户量，gmv 受损等等业务重视的指标。</p>
<p>基于规则，来判定，p0，p1，p2 等等各级别的事故级别。</p>
<p><font style="color:rgb(47, 48, 52);">同时认真仔细的回顾当时问题产生的时候，大家的状态和操作是否变形，找到可以优化的地方，比如有一个什么角色去并行做什么东西可以提高整体的效率等等。</font></p>
<p><font style="color:rgb(47, 48, 52);">复盘不是为了追责，喷人，只是为了让大家都知悉问题发生的过程，后续不再踩坑。<br></font><font style="color:rgb(47, 48, 52);">比如后续的报警措施啊，异常处理措施啊，优化思路啊，这次排查效率还有什么要优化的呀。沉淀思路啊。知识库沉淀，问题归档。</font></p>
<p><font style="color:rgb(47, 48, 52);">同时分析出问题产生的根本原因。开发阶段不行还是测试不行，还是产品流程问题，还是上线问题！</font></p>
<p><font style="color:rgb(47, 48, 52);">同时查看其他需求是否也有此问题。</font></p>
<h1 id="铭记"><a href="#铭记" class="headerlink" title="铭记"></a>铭记</h1><p><font style="color:rgb(47, 48, 52);">海恩法则，也被称为海恩法则或海因里希法则，是由德国飞机涡轮机的发明者帕布斯·海恩提出的。这一法则主要应用于航空界，强调飞行安全，但也被广泛应用于企业生产管理、安全管理和人力资源管理等领域。海恩法则的核心思想是，每一起严重事故的背后，必然有29次轻微事故和300起未遂先兆以及1000起事故隐患。</font></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/10/%E6%96%B9%E6%B3%95%E8%AE%BA/%E6%85%A2sql%E4%BC%98%E5%8C%96%E6%96%B9%E5%90%91%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/10/%E6%96%B9%E6%B3%95%E8%AE%BA/%E6%85%A2sql%E4%BC%98%E5%8C%96%E6%96%B9%E5%90%91%EF%BC%9F/" itemprop="url">慢sql优化方向</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-10T13:33:41+00:00">
                2025-04-10
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">方法论</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="慢sql优化方向？"><a href="#慢sql优化方向？" class="headerlink" title="慢sql优化方向？"></a>慢sql优化方向？</h1><h1 id="详细解读"><a href="#详细解读" class="headerlink" title="详细解读"></a>详细解读</h1><h3 id="1-优化查询语句"><a href="#1-优化查询语句" class="headerlink" title="1. 优化查询语句"></a>1. 优化查询语句</h3><h4 id="使用适当的索引"><a href="#使用适当的索引" class="headerlink" title="使用适当的索引"></a>使用适当的索引</h4><ul>
<li><strong>创建索引</strong>：确保查询使用了适当的索引。对频繁出现在WHERE、JOIN、ORDER BY和GROUP BY子句中的列创建索引。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX idx_column_name ON table_name(column_name);</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>复合索引</strong>：对于多列查询，考虑使用复合索引（多列索引）。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX idx_columns ON table_name(column1, column2);</span><br></pre></td></tr></table></figure>

<h4 id="避免全表扫描"><a href="#避免全表扫描" class="headerlink" title="避免全表扫描"></a>避免全表扫描</h4><ul>
<li><strong>使用合适的过滤条件</strong>：确保WHERE子句中的条件能够有效地利用索引，避免全表扫描。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT*FROM table_name WHERE indexed_column =&#x27;value&#x27;;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>限制返回的行数</strong>：使用LIMIT子句限制返回的行数，减少数据库的负担。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT*FROM table_name WHEREcondition LIMIT 10;</span><br></pre></td></tr></table></figure>

<h4 id="优化JOIN操作"><a href="#优化JOIN操作" class="headerlink" title="优化JOIN操作"></a>优化JOIN操作</h4><ul>
<li><strong>使用小表驱动大表</strong>：在JOIN操作中，确保小表在前，大表在后。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT*FROM small_table ST JOIN large_table LT ON ST.id = LT.id;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>索引连接列</strong>：确保连接列上有索引，以加快JOIN操作。</li>
</ul>
<h4 id="避免不必要的复杂查询"><a href="#避免不必要的复杂查询" class="headerlink" title="避免不必要的复杂查询"></a>避免不必要的复杂查询</h4><ul>
<li><strong>简化查询</strong>：尽量简化查询，避免使用不必要的子查询和嵌套查询。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 避免复杂的嵌套查询SELECT*FROM table_name WHERE id IN (SELECT id FROM another_table WHEREcondition);</span><br><span class="line">-- 使用JOIN替代SELECT table_name.*FROM table_name JOIN another_table ON table_name.id = another_table.id WHERE another_table.condition;</span><br></pre></td></tr></table></figure>

<h3 id="2-优化数据库设计"><a href="#2-优化数据库设计" class="headerlink" title="2. 优化数据库设计"></a>2. 优化数据库设计</h3><h4 id="规范化与反规范化"><a href="#规范化与反规范化" class="headerlink" title="规范化与反规范化"></a>规范化与反规范化</h4><ul>
<li><strong>规范化</strong>：确保数据库设计符合第三范式，减少数据冗余。</li>
<li><strong>反规范化</strong>：在某些情况下，为了性能，可以适度反规范化，减少复杂的JOIN操作。</li>
</ul>
<h4 id="分区表"><a href="#分区表" class="headerlink" title="分区表"></a>分区表</h4><ul>
<li><strong>表分区</strong>：对于非常大的表，可以使用表分区，将数据分成更小的部分，提高查询性能。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATETABLE orders (</span><br><span class="line">    order_id INT,</span><br><span class="line">    order_date DATE,</span><br><span class="line">    ...</span><br><span class="line">)PARTITIONBYRANGE (YEAR(order_date)) (</span><br><span class="line">    PARTITION p0 VALUES LESS THAN (2020),</span><br><span class="line">    PARTITION p1 VALUES LESS THAN (2021),</span><br><span class="line">    PARTITION p2 VALUES LESS THAN (2022)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="3-优化服务器配置"><a href="#3-优化服务器配置" class="headerlink" title="3. 优化服务器配置"></a>3. 优化服务器配置</h3><h4 id="调整-MySQL-配置参数"><a href="#调整-MySQL-配置参数" class="headerlink" title="调整 MySQL 配置参数"></a>调整 MySQL 配置参数</h4><ul>
<li><strong>调整缓冲池大小</strong>：对于 InnoDB 存储引擎，调整innodb_buffer_pool_size参数，使其尽量大（但不要超过物理内存的 70-80%）。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]innodb_buffer_pool_size = 4G</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>调整查询缓存</strong>：根据应用需求，调整查询缓存大小。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]query_cache_size = 64M</span><br></pre></td></tr></table></figure>

<h4 id="使用合适的存储引擎"><a href="#使用合适的存储引擎" class="headerlink" title="使用合适的存储引擎"></a>使用合适的存储引擎</h4><ul>
<li><strong>选择适当的存储引擎</strong>：根据应用需求选择合适的存储引擎（如 InnoDB、MyISAM）。</li>
</ul>
<h3 id="4-使用性能分析工具"><a href="#4-使用性能分析工具" class="headerlink" title="4. 使用性能分析工具"></a>4. 使用性能分析工具</h3><h4 id="使用EXPLAIN分析查询"><a href="#使用EXPLAIN分析查询" class="headerlink" title="使用EXPLAIN分析查询"></a>使用EXPLAIN分析查询</h4><ul>
<li><strong>分析执行计划</strong>：使用EXPLAIN分析查询的执行计划，识别性能瓶颈。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT*FROM your_table WHERE your_condition;</span><br></pre></td></tr></table></figure>

<h4 id="使用性能模式（Performance-Schema）"><a href="#使用性能模式（Performance-Schema）" class="headerlink" title="使用性能模式（Performance Schema）"></a>使用性能模式（Performance Schema）</h4><ul>
<li><strong>收集性能数据</strong>：使用 Performance Schema 收集详细的性能数据，分析慢查询。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT*FROM performance_schema.events_statements_summary_by_digestORDERBY SUM_TIMER_WAIT DESC</span><br><span class="line">LIMIT 10;</span><br></pre></td></tr></table></figure>

<h3 id="5-监控和调优"><a href="#5-监控和调优" class="headerlink" title="5. 监控和调优"></a>5. 监控和调优</h3><h4 id="持续监控"><a href="#持续监控" class="headerlink" title="持续监控"></a>持续监控</h4><ul>
<li><strong>使用监控工具</strong>：使用 MySQL Enterprise Monitor、Percona Monitoring and Management (PMM)、New Relic、Datadog 等工具持续监控数据库性能。</li>
</ul>
<h4 id="定期调优"><a href="#定期调优" class="headerlink" title="定期调优"></a>定期调优</h4><ul>
<li><strong>定期审查查询</strong>：定期审查和优化慢查询，确保数据库性能持续提升。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/09/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E7%86%9F%E6%82%89%E4%B8%80%E4%B8%AA%E5%A4%8D%E6%9D%82%E7%9A%84%E7%B3%BB%E7%BB%9F%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/09/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E7%86%9F%E6%82%89%E4%B8%80%E4%B8%AA%E5%A4%8D%E6%9D%82%E7%9A%84%E7%B3%BB%E7%BB%9F%EF%BC%9F/" itemprop="url">👌如何快速熟悉一个复杂的系统</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-09T13:33:41+00:00">
                2025-04-09
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">方法论</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌如何快速熟悉一个复杂的系统？"><a href="#👌如何快速熟悉一个复杂的系统？" class="headerlink" title="👌如何快速熟悉一个复杂的系统？"></a>👌如何快速熟悉一个复杂的系统？</h1><p><font style="color:rgb(47, 48, 52);">这个问题，是一道开放性的问题，很多小伙伴在面试的时候，尤其是一些高级的岗位，会被面试官问到，其实像这种问题，面试官的目的就是看你对于此是否有一定的方法论沉淀，如果平时只是一直在写crud，那么对于这种问题，一定是没有思考过的。通过此也能筛选出一些人的区分。</font></p>
<p><font style="color:rgb(47, 48, 52);">鸡翅老哥曾经做过好几次的大型项目的系统交接，每次交接都是对于一个系统从陌生到熟悉的过程，要进行快速掌控的过程。在这个过程中，你会遇到文档资料不全，原交接人可能直接离职了，找不到人。交接人没时间讲解业务等等等难受的问题，这个时候都是要靠自己来花时间处理。今天鸡翅老哥给大家沉淀一些方法论。</font></p>
<p><font style="color:rgb(47, 48, 52);">本篇文章的背景，我们就以一个背景来展开描述：一个大型的电商项目进行交接，你是其中的交接负责人，你该如何做？以及如何快速熟悉系统。</font></p>
<h2 id="盘资源，盘权限"><a href="#盘资源，盘权限" class="headerlink" title="盘资源，盘权限"></a><font style="color:rgb(47, 48, 52);">盘资源，盘权限</font></h2><p><font style="color:rgb(47, 48, 52);">在进行系统交接的时候，我们一定要做好的一件事就是和原来的团队，确认当前大项目所需要的各种清单，例如代码库，数据库资源，redis资源等中间件情况，网关域名资源等等等。这个时候要建立表格，确保交接人和被交接人，一项一项的都要进行check，防止遗漏，不然交接完之后，再发现缺东西，那就直接难受了。</font></p>
<h2 id="盘优先级"><a href="#盘优先级" class="headerlink" title="盘优先级"></a><font style="color:rgb(47, 48, 52);">盘优先级</font></h2><p><font style="color:rgb(47, 48, 52);">一个大型的项目是由很多子系统组成的，我见过最多的是100多个微服务应用。如果这么多的应用，全部由团队来进行熟悉，那就累到死了，一定要知道哪些是核心应用，哪些是非核心，我们可以编号，p0，p1，p2这种，这个过程和原来的团队要做好沟通，也为后续的熟悉做好基础。</font></p>
<h2 id="盘业务"><a href="#盘业务" class="headerlink" title="盘业务"></a><font style="color:rgb(47, 48, 52);">盘业务</font></h2><p><font style="color:rgb(47, 48, 52);">从看的见，摸得着的层面盘清之后，就可以开始盘业务，这个过程要依靠原有团队的讲解，以及沉淀的业务文档来进行学习和梳理。如果二者都没有，那么恭喜，步入地狱难度，需要自己通过体验产品，来划分出模块，盘出整个业务，这个地方也是有技巧，首先要划清用例者，用户身份，运营身份，等等各种身份，基于身份的形式，体验产品的整个流程并形成自己的认知业务文档。</font></p>
<h2 id="盘技术栈"><a href="#盘技术栈" class="headerlink" title="盘技术栈"></a><font style="color:rgb(47, 48, 52);">盘技术栈</font></h2><p><font style="color:rgb(47, 48, 52);">从这个地方开始就是熟悉系统的流程，先去熟悉技术栈，都是采用的什么语言，什么中间件，什么开源，基于什么样的形式进行交互，这个过程从核心系统开始，看pom文件，配置文件来了解其中的技术点。比如看到mq，大概就能猜到项目里面有异步的数据流交互，看到es，猜测这个应用是具备大数据量的处理和查询。</font></p>
<h2 id="盘入口"><a href="#盘入口" class="headerlink" title="盘入口"></a><font style="color:rgb(47, 48, 52);">盘入口</font></h2><p><font style="color:rgb(47, 48, 52);">什么叫入口呢，controller，对外提供的rpc，http能力，定时任务，这些都是入口，从入口来入手业务逻辑是最快的一种方式，所以先找项目的统一对外出口，不然直接看内部的逻辑，是会发懵的，比如从一个controller开始看起，就知道了这个项目对外提供的是什么模块，什么功能。方便我们去理解。</font></p>
<h2 id="盘数据流"><a href="#盘数据流" class="headerlink" title="盘数据流"></a><font style="color:rgb(47, 48, 52);">盘数据流</font></h2><p><font style="color:rgb(47, 48, 52);">有了入口之后，其实我们已经大概知道该系统提供的能力是什么。在通过入口进行再深一层的看，就知道数据的流向是什么情况，在这个过程中，其实可以初步梳理出一个功能整体的系统交互和数据流向。这也是最耗时间的一个环节。</font></p>
<h2 id="盘核心和易出问题的点"><a href="#盘核心和易出问题的点" class="headerlink" title="盘核心和易出问题的点"></a><font style="color:rgb(47, 48, 52);">盘核心和易出问题的点</font></h2><p><font style="color:rgb(47, 48, 52);">我们一个大项目的交接会有很多项目，如果挨个都看，不分优先级的去看，是很耗费时间和精力的，所以按照核心应用开始，以及找出平时容易出问题的点的应用，这种的收益是最大的。时间是宝贵的，我们也应该从这方面来进行熟悉。</font></p>
<h2 id="盘细节"><a href="#盘细节" class="headerlink" title="盘细节"></a><font style="color:rgb(47, 48, 52);">盘细节</font></h2><p><font style="color:rgb(47, 48, 52);">细节就不用说了，有了上面的这些铺垫之后，接下来要做的就是一个模块一个模块的整体的代码逻辑梳理，切忌每一行代码都看，要看核心的，简单的地方，了解数据流的大概即可。这样我们可以快速交接项目。</font></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/09/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E7%9B%91%E6%8E%A7%E6%85%A2sql%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/09/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E7%9B%91%E6%8E%A7%E6%85%A2sql%EF%BC%9F/" itemprop="url">👌如何监控慢sql？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-09T13:33:41+00:00">
                2025-04-09
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">方法论</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌如何监控慢sql？"><a href="#👌如何监控慢sql？" class="headerlink" title="👌如何监控慢sql？"></a>👌如何监控慢sql？</h1><h3 id="1-启用慢查询日志"><a href="#1-启用慢查询日志" class="headerlink" title="1. 启用慢查询日志"></a>1. 启用慢查询日志</h3><p>慢查询日志是 MySQL 内置的一种功能，用于记录执行时间超过指定阈值的 SQL 查询。</p>
<h4 id="配置-MySQL-配置文件（my-cnf-或-my-ini）"><a href="#配置-MySQL-配置文件（my-cnf-或-my-ini）" class="headerlink" title="配置 MySQL 配置文件（my.cnf 或 my.ini）"></a>配置 MySQL 配置文件（my.cnf 或 my.ini）</h4><p>在 MySQL 配置文件中添加或修改以下参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">slow_query_log = 1</span><br><span class="line">slow_query_log_file = /var/log/mysql/slow-query.log</span><br><span class="line">long_query_time = 2</span><br><span class="line">log_queries_not_using_indexes = 1</span><br></pre></td></tr></table></figure>

<ul>
<li>slow_query_log：启用慢查询日志。</li>
<li>slow_query_log_file：指定慢查询日志文件的路径。</li>
<li>long_query_time：定义慢查询的阈值（单位：秒）。</li>
<li>log_queries_not_using_indexes：记录未使用索引的查询。</li>
</ul>
<h4 id="重启-MySQL-服务"><a href="#重启-MySQL-服务" class="headerlink" title="重启 MySQL 服务"></a>重启 MySQL 服务</h4><p>修改配置文件后，重启 MySQL 服务以使配置生效：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart mysql</span><br></pre></td></tr></table></figure>

<h3 id="2-使用-MySQL-内置的性能模式（Performance-Schema）"><a href="#2-使用-MySQL-内置的性能模式（Performance-Schema）" class="headerlink" title="2. 使用 MySQL 内置的性能模式（Performance Schema）"></a>2. 使用 MySQL 内置的性能模式（Performance Schema）</h3><p>Performance Schema 是 MySQL 内置的一个工具，用于收集数据库内部的运行时统计信息。可以通过以下步骤启用和使用 Performance Schema：</p>
<h4 id="启用-Performance-Schema"><a href="#启用-Performance-Schema" class="headerlink" title="启用 Performance Schema"></a>启用 Performance Schema</h4><p>在 MySQL 配置文件中添加或修改以下参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">performance_schema = ON</span><br></pre></td></tr></table></figure>

<h4 id="重启-MySQL-服务-1"><a href="#重启-MySQL-服务-1" class="headerlink" title="重启 MySQL 服务"></a>重启 MySQL 服务</h4><p>修改配置文件后，重启 MySQL 服务以使配置生效：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart mysql</span><br></pre></td></tr></table></figure>

<h4 id="查询慢查询信息"><a href="#查询慢查询信息" class="headerlink" title="查询慢查询信息"></a>查询慢查询信息</h4><p>使用以下 SQL 语句查询慢查询信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT*FROM performance_schema.events_statements_summary_by_digestORDERBY SUM_TIMER_WAIT DESC</span><br><span class="line">LIMIT 10;</span><br></pre></td></tr></table></figure>

<h3 id="3-使用-MySQL-企业监控工具"><a href="#3-使用-MySQL-企业监控工具" class="headerlink" title="3. 使用 MySQL 企业监控工具"></a>3. 使用 MySQL 企业监控工具</h3><p>MySQL 提供了企业版的监控工具，如 MySQL Enterprise Monitor，它可以自动收集、分析和报告慢查询信息。这个工具适合企业环境下的全面监控和管理。</p>
<h3 id="4-使用第三方监控工具"><a href="#4-使用第三方监控工具" class="headerlink" title="4. 使用第三方监控工具"></a>4. 使用第三方监控工具</h3><p>有许多第三方监控工具可以帮助你监控 MySQL 的性能，包括慢查询。这些工具通常提供更丰富的功能和更友好的界面。常见的第三方工具包括：</p>
<ul>
<li>**Percona Monitoring and Management (PMM)**：一个开源的监控和管理工具，专为 MySQL 和 MongoDB 设计。</li>
<li><strong>New Relic</strong>：一个强大的应用性能监控工具，支持 MySQL 和其他数据库。</li>
<li><strong>Datadog</strong>：一个综合性的监控平台，支持 MySQL 和其他数据库。</li>
</ul>
<h3 id="5-使用-SQL-分析工具"><a href="#5-使用-SQL-分析工具" class="headerlink" title="5. 使用 SQL 分析工具"></a>5. 使用 SQL 分析工具</h3><p>MySQL 提供了EXPLAIN语句，用于分析 SQL 查询的执行计划。通过分析执行计划，可以识别和优化慢查询。</p>
<h4 id="使用EXPLAIN分析查询"><a href="#使用EXPLAIN分析查询" class="headerlink" title="使用EXPLAIN分析查询"></a>使用EXPLAIN分析查询</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT*FROM your_table WHERE your_condition;</span><br></pre></td></tr></table></figure>

<p>EXPLAIN的输出结果包含了查询执行的详细信息，包括使用的索引、扫描的行数等。通过分析这些信息，可以找出查询的性能瓶颈并进行优化。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>监控慢 SQL 是一个持续的过程，需要结合多种工具和方法。以下是一个综合的监控策略：</p>
<ol>
<li><strong>启用慢查询日志</strong>：记录执行时间超过阈值的查询。</li>
<li><strong>使用 Performance Schema</strong>：收集和分析详细的运行时统计信息。</li>
<li><strong>使用企业监控工具</strong>：如 MySQL Enterprise Monitor，进行全面的监控和管理。</li>
<li><strong>使用第三方监控工具</strong>：如 Percona Monitoring and Management (PMM)、New Relic、Datadog 等。</li>
<li><strong>使用 SQL 分析工具</strong>：如EXPLAIN，分析和优化查询执行计划。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/04/09/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E5%A5%BD%E4%B8%80%E4%B8%AA%E6%8E%A5%E5%8F%A3%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/04/09/%E6%96%B9%E6%B3%95%E8%AE%BA/%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E5%A5%BD%E4%B8%80%E4%B8%AA%E6%8E%A5%E5%8F%A3%EF%BC%9F/" itemprop="url">👌如何设计好一个接口？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-04-09T13:33:41+00:00">
                2025-04-09
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">方法论</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌如何设计好一个接口？"><a href="#👌如何设计好一个接口？" class="headerlink" title="👌如何设计好一个接口？"></a>👌如何设计好一个接口？</h1><p>这个问题是非常常见的一个问题。无论是在日常写代码的时候，还是实际面试的时候！</p>
<p>说实话，面试过很多人，上来一问，就是一句，没啥可以设计的，能正常使用查询即可，这种我都直接给他 pass 掉。</p>
<p>从设计接口的角度，主要需要遵循几个规范：</p>
<h1 id="接口命名"><a href="#接口命名" class="headerlink" title="接口命名"></a>接口命名</h1><p>命名的时候，别在那瞎搞，瞎起，不断增加后面人的理解成本，一定要见名知意。清晰，遵循开发规范。常见的规范可以直接参考阿里巴巴开发规范。不要觉得这些东西很麻烦，对于有经验的开发人员，大家遵守相同的规范，可以快速入手，一下子就明白，高手过招，无需多言。</p>
<p>接口设计的时候，遵循单一指责，不要做什么大而全的，比如下单并支付，千万别这么设计，createOrderAndPay。一定要做拆分，createOrder。payOrder。职责单一。</p>
<h1 id="参数校验"><a href="#参数校验" class="headerlink" title="参数校验"></a>参数校验</h1><p>好的接口，入参和出参的校验，一定要做好处理！参数前置校验做的好，在后面的核心业务代码，可以节省很多时间，核心业务代码，可以专注的处理业务逻辑。大家在开发过程中，有很多的时候，参数校验没做好，到业务代码，空指针等等问题，这些都是可以提前规避的。</p>
<p>对于出参的校验，做好错误码的定义。定义好具体的错误文案对应。要做友好的展示。不要提示参数错误，而是要提示具体的参数问题。</p>
<h1 id="日志打印"><a href="#日志打印" class="headerlink" title="日志打印"></a>日志打印</h1><p>关键日志必须打印打印打印！！！！经常有问题的时候，因为关键日志不打印，导致排查和理解的成本特别高，方法的入参和出参的日志可以通过拦截器来进行处理。</p>
<p>然后就是核心代码的关键日志。一定要打，比如经历了一些复杂逻辑的转换，关键的步骤打印日志。</p>
<p>打印日志要注意级别。error 、warn 、info 、debug。</p>
<p>公共包的，经历过大规模考验的 debug 即可。</p>
<p>普通业务就是 info。要注意，大 json 转换，加 isinfo 的判断，防止影响性能。</p>
<p>error 不要乱打，真错误的时候再打。蛇打七寸。</p>
<h1 id="性能设计"><a href="#性能设计" class="headerlink" title="性能设计"></a>性能设计</h1><p>对于核心接口设计的时候，必须有监控和异常的报警机制。tp99，qps，可用率。这些都要看到。</p>
<p>要考虑调用第三方接口，第三方的性能会不会影响自己，第三方失败的时候，如何进行处理。重试还是失败等等。</p>
<p>要不要加缓存，提升性能，要不要用多线程提升性能。要不要幂等，数据库压力等等都要考虑。</p>
<h1 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h1><p>一定要考虑接口的各种异常情况，应该产生的相关行为。要尽量预知做处理。不要产生不可控情况。相关校验做好。还有就是常见的你提供的接口的超时问题，要做好超时事件设置，自身也可以进行快速熔断返回。自身接口超时时间要小于上游接口。</p>
<h1 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h1><p>都给鸡哥写注释，别给鸡哥在这防御性编程，不写注释是一个非常坏的习惯！！到时候，你自己回过头可能都看不懂了。</p>
<h1 id="限流-x2F-熔断"><a href="#限流-x2F-熔断" class="headerlink" title="限流&#x2F;熔断"></a>限流&#x2F;熔断</h1><p>自己的接口要考虑好下下策，如果大流量来了，我们的服务是否能支撑的住，提前最好评估和限制调用方流量，防止自己什么都吃，导致服务整体直接不可用。极端情况也可以做熔断和快速失败，总之就是要保护好自己！</p>
<h2 id="接口文档"><a href="#接口文档" class="headerlink" title="接口文档"></a><strong>接口文档</strong></h2><p>写个清晰的接口文档，可以减少很多不必要的沟通和交流，一个好的接口文档，调用方的人，一看就懂，自然就不用浪费你的时间，教他传什么了。这种可以极大的减少沟通成本。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/03/22/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/03/22/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/" itemprop="url">分布式锁切面(DistributeLockAspect)代码解读</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-03-22T17:33:00+00:00">
                2025-03-22
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" itemprop="url" rel="index">
                    <span itemprop="name">分布式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="分布式锁切面-DistributeLockAspect-代码解读"><a href="#分布式锁切面-DistributeLockAspect-代码解读" class="headerlink" title="分布式锁切面(DistributeLockAspect)代码解读"></a>分布式锁切面(DistributeLockAspect)代码解读</h1><ul>
<li>这是一个基于Spring AOP和Redisson实现的分布式锁切面，用于在方法执行前获取分布式锁，执行后释放锁。下面我将从多个维度详细解析这段代码：</li>
</ul>
<h2 id="一、核心功能概述"><a href="#一、核心功能概述" class="headerlink" title="一、核心功能概述"></a>一、核心功能概述</h2><p>该切面主要实现以下功能：</p>
<ul>
<li><p>通过@DistributeLock注解标记需要加锁的方法</p>
</li>
<li><p>支持动态生成锁的key（使用SpEL表达式）</p>
</li>
<li><p>提供多种加锁策略（立即加锁、尝试加锁、带过期时间的锁）</p>
</li>
<li><p>确保锁的最终释放（在finally块中）</p>
</li>
</ul>
<h2 id="二、代码结构解析"><a href="#二、代码结构解析" class="headerlink" title="二、代码结构解析"></a>二、代码结构解析</h2><ol>
<li><p>类定义与依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Aspect</span><br><span class="line">@Component</span><br><span class="line">@Order(Integer.MIN_VALUE)  // 确保最先执行</span><br><span class="line">public class DistributeLockAspect &#123;</span><br><span class="line">    private RedissonClient redissonClient;  // Redisson客户端</span><br><span class="line">    </span><br><span class="line">    // 构造函数注入</span><br><span class="line">    public DistributeLockAspect(RedissonClient redissonClient) &#123;</span><br><span class="line">        this.redissonClient = redissonClient;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@Aspect：声明这是一个切面类</span><br><span class="line"></span><br><span class="line">@Order(Integer.MIN_VALUE)：确保这个切面在调用链中最早执行</span><br><span class="line"></span><br><span class="line">通过构造函数注入RedissonClient，用于操作分布式锁</span><br></pre></td></tr></table></figure>

</li>
<li><p>核心切面方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Around(&quot;@annotation(cn.hollis.nft.turbo.lock.DistributeLock)&quot;)</span><br><span class="line">public Object process(ProceedingJoinPoint pjp) throws Exception</span><br><span class="line">使用@Around注解拦截所有带有@DistributeLock注解的方法</span><br><span class="line"></span><br><span class="line">ProceedingJoinPoint参数可以获取被拦截方法的信息</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="三、关键实现逻辑"><a href="#三、关键实现逻辑" class="headerlink" title="三、关键实现逻辑"></a>三、关键实现逻辑</h2><ol>
<li>锁Key的生成<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">String key = distributeLock.key();</span><br><span class="line">if (DistributeLockConstant.NONE_KEY.equals(key)) &#123;</span><br><span class="line">    // 使用SpEL表达式动态生成key</span><br><span class="line">    SpelExpressionParser parser = new SpelExpressionParser();</span><br><span class="line">    Expression expression = parser.parseExpression(distributeLock.keyExpression());</span><br><span class="line">    // 设置上下文变量</span><br><span class="line">    EvaluationContext context = new StandardEvaluationContext();</span><br><span class="line">    Object[] args = pjp.getArgs();</span><br><span class="line">    String[] parameterNames = discoverer.getParameterNames(method);</span><br><span class="line">    // 绑定参数到上下文</span><br><span class="line">    for (int i = 0; i &lt; parameterNames.length; i++) &#123;</span><br><span class="line">        context.setVariable(parameterNames[i], args[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    key = String.valueOf(expression.getValue(context));</span><br><span class="line">&#125;</span><br><span class="line">String scene = distributeLock.scene();</span><br><span class="line">String lockKey = scene + &quot;#&quot; + key;  // 最终锁key</span><br></pre></td></tr></table></figure></li>
</ol>
<p>支持静态key和动态key两种方式</p>
<p>动态key使用SpEL表达式，可以从方法参数中取值</p>
<p>最终key格式为scene#key，便于分类管理</p>
<ol start="2">
<li>加锁逻辑<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">RLock rLock= redissonClient.getLock(lockKey);</span><br><span class="line">try &#123;</span><br><span class="line">    boolean lockResult = false;</span><br><span class="line">    if (waitTime == DistributeLockConstant.DEFAULT_WAIT_TIME) &#123;</span><br><span class="line">        // 立即加锁逻辑</span><br><span class="line">        if (expireTime == DistributeLockConstant.DEFAULT_EXPIRE_TIME) &#123;</span><br><span class="line">            rLock.lock();  // 永久锁</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            rLock.lock(expireTime, TimeUnit.MILLISECONDS);  // 带过期时间的锁</span><br><span class="line">        &#125;</span><br><span class="line">        lockResult = true;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        // 尝试加锁逻辑</span><br><span class="line">        if (expireTime == DistributeLockConstant.DEFAULT_EXPIRE_TIME) &#123;</span><br><span class="line">            lockResult = rLock.tryLock(waitTime, TimeUnit.MILLISECONDS);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            lockResult = rLock.tryLock(waitTime, expireTime, TimeUnit.MILLISECONDS);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if (!lockResult) &#123;</span><br><span class="line">        throw new DistributeLockException(&quot;acquire lock failed... key : &quot; + lockKey);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 执行目标方法</span><br><span class="line">    response = pjp.proceed();</span><br><span class="line">&#125; finally &#123;</span><br><span class="line">    // 释放锁</span><br><span class="line">    if (rLock.isHeldByCurrentThread()) &#123;</span><br><span class="line">        rLock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>支持四种加锁模式：</p>
<ul>
<li><p>永久锁（无过期时间）</p>
</li>
<li><p>带过期时间的锁</p>
</li>
<li><p>尝试获取锁（带等待时间）</p>
</li>
<li><p>尝试获取带过期时间的锁（带等待时间和过期时间）</p>
</li>
</ul>
<p>确保锁最终会被释放（finally块）</p>
<h2 id="四、设计亮点"><a href="#四、设计亮点" class="headerlink" title="四、设计亮点"></a>四、设计亮点</h2><p>灵活的锁Key生成：支持静态key和SpEL动态key</p>
<p>多种加锁策略：满足不同业务场景需求</p>
<p>线程安全：确保只有持有锁的线程才能释放锁</p>
<p>日志完备：记录加锁、释放锁的关键信息</p>
<p>异常处理：加锁失败抛出特定异常</p>
<h2 id="五、使用示例"><a href="#五、使用示例" class="headerlink" title="五、使用示例"></a>五、使用示例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class OrderService &#123;</span><br><span class="line">    @DistributeLock(</span><br><span class="line">        scene = &quot;order&quot;,</span><br><span class="line">        keyExpression = &quot;#orderId&quot;,  // 使用SpEL从参数获取值</span><br><span class="line">        expireTime = 5000</span><br><span class="line">    )</span><br><span class="line">    public void processOrder(String orderId) &#123;</span><br><span class="line">        // 业务逻辑</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="六、改进建议"><a href="#六、改进建议" class="headerlink" title="六、改进建议"></a>六、改进建议</h2><p>锁的可重入性：Redisson的RLock本身支持可重入，但可以增加重入计数日志</p>
<p>锁的自动续期：对于长时间任务，可以实现锁的自动续期</p>
<p>更细粒度的异常处理：区分业务异常和锁相关的异常</p>
<p>性能监控：添加锁获取时间、持有时间等监控指标</p>
<p>这个切面实现了一个完整且健壮的分布式锁解决方案，可以很好地应用于需要分布式锁的业务场景中。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/03/16/%E5%88%86%E5%B8%83%E5%BC%8F/%E4%BB%80%E4%B9%88%E6%98%AFTCC%E6%A8%A1%E5%BC%8F%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/03/16/%E5%88%86%E5%B8%83%E5%BC%8F/%E4%BB%80%E4%B9%88%E6%98%AFTCC%E6%A8%A1%E5%BC%8F%EF%BC%9F/" itemprop="url">什么是TCC（Try-Confirm/Cancel）模式？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-03-16T13:33:41+00:00">
                2025-03-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" itemprop="url" rel="index">
                    <span itemprop="name">分布式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="什么是TCC（Try-Confirm-x2F-Cancel）模式？"><a href="#什么是TCC（Try-Confirm-x2F-Cancel）模式？" class="headerlink" title="什么是TCC（Try-Confirm&#x2F;Cancel）模式？"></a>什么是TCC（Try-Confirm&#x2F;Cancel）模式？</h1><p>TCC（Try-Confirm&#x2F;Cancel）模式是一种分布式事务管理模式，用于确保分布式系统中的数据一致性。它通过将事务分解为三个阶段：尝试（Try）、确认（Confirm）和取消（Cancel），来实现分布式事务的管理和控制。</p>
<h3 id="TCC模式的三个阶段"><a href="#TCC模式的三个阶段" class="headerlink" title="TCC模式的三个阶段"></a>TCC模式的三个阶段</h3><ol>
<li><strong>尝试（Try）</strong>：<ul>
<li>尝试阶段是预留资源或锁定资源的阶段。</li>
<li>该阶段确保所有需要的资源都可以被成功预留，以便后续的确认操作能够顺利进行。</li>
<li>这一步不会真正提交事务，只是做预留操作。</li>
</ul>
</li>
<li><strong>确认（Confirm）</strong>：<ul>
<li>确认阶段是实际提交事务的阶段。</li>
<li>在这个阶段，系统会确认并提交所有的操作，确保数据的最终一致性。</li>
<li>如果尝试阶段成功，确认阶段应该始终成功。</li>
</ul>
</li>
<li><strong>取消（Cancel）</strong>：<ul>
<li>取消阶段是回滚事务的阶段。</li>
<li>如果尝试阶段失败，或者确认阶段未能执行，系统会执行取消操作来释放预留的资源或回滚已经进行的操作。</li>
<li>这一步确保系统能够恢复到尝试阶段之前的状态。</li>
</ul>
</li>
</ol>
<h3 id="TCC模式的工作流程"><a href="#TCC模式的工作流程" class="headerlink" title="TCC模式的工作流程"></a>TCC模式的工作流程</h3><ol>
<li><strong>尝试阶段</strong>：<ul>
<li>各个服务预留资源或锁定资源。</li>
<li>如果所有服务的尝试操作都成功，则进入确认阶段；否则，进入取消阶段。</li>
</ul>
</li>
<li><strong>确认阶段</strong>：<ul>
<li>各个服务正式提交事务，完成实际操作。</li>
<li>确认阶段的操作应当是幂等的（即多次执行结果相同）。</li>
</ul>
</li>
<li><strong>取消阶段</strong>：<ul>
<li>如果尝试阶段中的任何一个操作失败，或者确认阶段未能成功执行，系统会调用取消操作来回滚事务。</li>
<li>取消阶段的操作也应当是幂等的。</li>
</ul>
</li>
</ol>
<h3 id="TCC模式的优缺点"><a href="#TCC模式的优缺点" class="headerlink" title="TCC模式的优缺点"></a>TCC模式的优缺点</h3><p><strong>优点</strong>：</p>
<ol>
<li><strong>强一致性</strong>：通过明确的三阶段操作，确保了分布式事务的强一致性。</li>
<li><strong>灵活性</strong>：可以根据业务需求灵活定义每个阶段的操作。</li>
<li><strong>幂等性</strong>：由于确认和取消操作需要幂等性，确保了系统的稳定性和可靠性。</li>
</ol>
<p><strong>缺点</strong>：</p>
<ol>
<li><strong>复杂性</strong>：需要为每个操作定义对应的尝试、确认和取消操作，增加了系统设计和实现的复杂性。</li>
<li><strong>资源占用</strong>：尝试阶段需要预留资源，可能会导致资源占用时间较长。</li>
<li><strong>实现成本</strong>：需要确保每个阶段的操作都是幂等的，增加了开发和维护成本。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/03/10/Spring/%E8%A7%A3%E9%87%8A%E4%B8%80%E4%B8%8BSpring%E7%9A%84ioc%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/03/10/Spring/%E8%A7%A3%E9%87%8A%E4%B8%80%E4%B8%8BSpring%E7%9A%84ioc%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC%EF%BC%9F/" itemprop="url">👌解释一下 Spring 的 ioc 控制反转</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-03-10T13:33:41+00:00">
                2025-03-10
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌解释一下-Spring-的-ioc-控制反转？"><a href="#👌解释一下-Spring-的-ioc-控制反转？" class="headerlink" title="👌解释一下 Spring 的 ioc 控制反转？"></a>👌解释一下 Spring 的 ioc 控制反转？</h1><h1 id="口语化回答"><a href="#口语化回答" class="headerlink" title="口语化回答"></a>口语化回答</h1><p>好的，面试官，控制反转通过将对象的创建和依赖关系的管理交给Spring IoC容器，极大地提高了代码的模块化和可维护性。IoC的主要实现方式是依赖注入，其中通过构造函数注入、Setter方法注入和字段注入等形式来注入，这样 Spring容器能够自动管理对象的依赖关系，使得应用程序代码更加简洁。以上。</p>
<h1 id="题目解析"><a href="#题目解析" class="headerlink" title="题目解析"></a>题目解析</h1><p>重点高频题。主要思路就是聊 ioc 是什么，再说说 di 的形式，最后说一下好处即可。</p>
<h1 id="面试得分点"><a href="#面试得分点" class="headerlink" title="面试得分点"></a>面试得分点</h1><p>反转，解耦，注入</p>
<h1 id="题目详细答案"><a href="#题目详细答案" class="headerlink" title="题目详细答案"></a>题目详细答案</h1><h2 id="什么是控制反转（IoC）？"><a href="#什么是控制反转（IoC）？" class="headerlink" title="什么是控制反转（IoC）？"></a>什么是控制反转（IoC）？</h2><p>在传统的编程模型中，应用程序代码通常直接控制对象的创建和依赖关系。例如，一个对象需要依赖另一个对象时，通常会在代码中直接创建依赖对象。这种方式使得代码紧密耦合，不利于测试和维护。</p>
<p>控制反转的理念是将这种控制权从应用程序代码中移除，转而交给一个容器来管理。这个容器就是Spring IoC容器。通过这种方式，对象的创建和依赖关系的管理被反转了，应用程序代码不再负责这些任务，而是由容器来处理。</p>
<h2 id="依赖注入（DI）"><a href="#依赖注入（DI）" class="headerlink" title="依赖注入（DI）"></a>依赖注入（DI）</h2><p>依赖注入是实现控制反转的一种方式。它主要有以下几种形式：</p>
<p><strong>构造函数注入</strong>：通过构造函数将依赖对象传递给被依赖对象。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Service &#123;</span><br><span class="line">    private final Repository repository;</span><br><span class="line"></span><br><span class="line">    public Service(Repository repository) &#123;</span><br><span class="line">        this.repository = repository;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Setter方法注入</strong>：通过Setter方法将依赖对象注入到被依赖对象中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Service &#123;</span><br><span class="line">    private Repository repository;</span><br><span class="line"></span><br><span class="line">    public void setRepository(Repository repository) &#123;</span><br><span class="line">        this.repository = repository;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>字段注入</strong>：直接在字段上使用注解进行注入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public class Service &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private Repository repository;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Spring-IoC-容器"><a href="#Spring-IoC-容器" class="headerlink" title="Spring IoC 容器"></a>Spring IoC 容器</h2><p>Spring IoC容器负责管理应用程序中对象的生命周期和依赖关系。它的主要职责包括：</p>
<p><strong>对象的创建</strong>：根据配置文件或注解创建对象。</p>
<p><strong>依赖注入</strong>：将对象的依赖注入到相应的对象中。</p>
<p><strong>对象的销毁</strong>：在适当的时候销毁对象，释放资源。</p>
<h3 id="配置方式"><a href="#配置方式" class="headerlink" title="配置方式"></a>配置方式</h3><p>Spring IoC容器可以通过多种方式进行配置：</p>
<p><strong>XML配置</strong>：通过XML文件定义Bean及其依赖关系。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans&gt;</span><br><span class="line">    &lt;bean id=&quot;repository&quot; class=&quot;com.example.Repository&quot;/&gt;</span><br><span class="line">    &lt;bean id=&quot;service&quot; class=&quot;com.example.Service&quot;&gt;</span><br><span class="line">        &lt;constructor-arg ref=&quot;repository&quot;/&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p><strong>Java配置</strong>：通过Java类和注解定义Bean及其依赖关系。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class AppConfig &#123;</span><br><span class="line">    @Bean</span><br><span class="line">    public Repository repository() &#123;</span><br><span class="line">        return new Repository();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public Service service() &#123;</span><br><span class="line">        return new Service(repository());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注解配置</strong>：通过注解（如@Component,@Autowired）自动扫描和注入Bean。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class Repository &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Component</span><br><span class="line">public class Service &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private Repository repository;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/03/09/Spring/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/03/09/Spring/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" itemprop="url">👌什么是动态代理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-03-09T13:33:41+00:00">
                2025-03-09
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌什么是动态代理"><a href="#👌什么是动态代理" class="headerlink" title="👌什么是动态代理"></a>👌什么是动态代理</h1><h1 id="口语化回答"><a href="#口语化回答" class="headerlink" title="口语化回答"></a>口语化回答</h1><p>好的，面试官。动态代理主要是在我们的程序运行时动态生成一种代理类的机制，让我们在不修改原始类的情况下，可以帮助原始类增加一些功能。通常有两种方式，一种是 jdk 的 proxy，一种是 cglib。动态代理在 spring 框架中的应用也非常常见。主要的 aop 机制就是通过动态代理实现。那么动态代理主要的优势就是解耦，减少代码重复，同时增强现有代码。以上。</p>
<h1 id="题目解析"><a href="#题目解析" class="headerlink" title="题目解析"></a>题目解析</h1><p>问到这道题的时候，大家一定要 cglib 和 spring 框架上面靠一靠，去埋点，让面试官继续追问下面的题目。</p>
<h1 id="面试得分点"><a href="#面试得分点" class="headerlink" title="面试得分点"></a>面试得分点</h1><p>增强行为，动态代理过程，减少重复代码</p>
<h1 id="题目详细答案"><a href="#题目详细答案" class="headerlink" title="题目详细答案"></a>题目详细答案</h1><p>动态代理是一种在运行时动态生成代理类的机制，它允许我们在不修改原始类的情况下增强或修改其行为。动态代理是通过java.lang.reflect.Proxy类和java.lang.reflect.InvocationHandler接口来实现的。</p>
<h2 id="动态代理的基本概念"><a href="#动态代理的基本概念" class="headerlink" title="动态代理的基本概念"></a>动态代理的基本概念</h2><p><strong>代理类（Proxy Class）</strong>：一个代理类是一个实现了一个或多个接口的类，它可以在运行时动态生成。代理类的实例可以用来代替原始对象，并在调用方法时执行额外的逻辑。</p>
<p><strong>调用处理器（Invocation Handler）</strong>：调用处理器是一个实现了InvocationHandler接口的类，它定义了代理类的方法调用逻辑。每次代理对象的方法被调用时，调用处理器的invoke方法都会被执行。</p>
<h2 id="动态代理的作用和优势"><a href="#动态代理的作用和优势" class="headerlink" title="动态代理的作用和优势"></a>动态代理的作用和优势</h2><p><strong>1、 解耦业务逻辑和通用功能</strong>：动态代理允许将通用功能（如日志记录、事务管理、安全性检查等）从业务逻辑中分离出来，从而提高代码的模块化和可维护性。</p>
<p><strong>2、 灵活性</strong>：动态代理在运行时生成代理类，不需要在编译时确定代理类，因此具有很大的灵活性。</p>
<p><strong>3、 减少代码重复</strong>：通过动态代理，可以将通用功能集中到一个地方，从而减少代码重复。</p>
<p><strong>4、 增强现有代码</strong>：动态代理允许在不修改现有代码的情况下增强其功能。</p>
<h3 id="动态代理的应用场景"><a href="#动态代理的应用场景" class="headerlink" title="动态代理的应用场景"></a>动态代理的应用场景</h3><p><strong>1、AOP（面向切面编程）</strong>：动态代理是实现 AOP 的核心技术之一，通过动态代理可以在方法执行前后添加横切关注点（如日志记录、事务管理等）。</p>
<p><strong>2、 远程方法调用（RMI）</strong>：动态代理可以用来实现客户端和服务器之间的远程方法调用。</p>
<p><strong>3、 装饰器模式</strong>：动态代理可以用来实现装饰器模式，在不修改原始类的情况下增强其功能。</p>
<p><strong>4、 框架和中间件</strong>：许多框架和中间件（如 Spring、Hibernate 等）都使用动态代理来实现其核心功能。</p>
<p>动态代理通过在运行时生成代理类，提供了一种灵活且强大的方式来增强现有代码的功能，而无需修改原始代码。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/03/06/Spring/Spring%E4%BA%8B%E5%8A%A1%E4%B8%AD%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%9C%89%E5%93%AA%E5%87%A0%E7%A7%8D%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/03/06/Spring/Spring%E4%BA%8B%E5%8A%A1%E4%B8%AD%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%9C%89%E5%93%AA%E5%87%A0%E7%A7%8D%EF%BC%9F/" itemprop="url">👌Spring事务中的隔离级别有哪几种？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-03-06T13:33:41+00:00">
                2025-03-06
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌Spring事务中的隔离级别有哪几种？"><a href="#👌Spring事务中的隔离级别有哪几种？" class="headerlink" title="👌Spring事务中的隔离级别有哪几种？"></a>👌Spring事务中的隔离级别有哪几种？</h1><h1 id="题目详细答案"><a href="#题目详细答案" class="headerlink" title="题目详细答案"></a>题目详细答案</h1><p>在 Spring 中，事务的隔离级别（Isolation Level）定义了一个事务与其他事务隔离的程度。隔离级别控制着事务在并发访问数据库时的行为，特别是如何处理多个事务同时读取和修改数据的情况。不同的隔离级别提供了不同的并发性和数据一致性保证。</p>
<p>Spring 提供了以下几种隔离级别，通过@Transactional注解的isolation属性来配置：</p>
<p>DEFAULT：使用底层数据库的默认隔离级别。通常情况下，这个默认值是READ_COMMITTED。</p>
<p>READ_UNCOMMITTED：允许一个事务读取另一个事务尚未提交的数据。可能会导致脏读（Dirty Read）、不可重复读（Non-repeatable Read）和幻读（Phantom Read）问题。</p>
<p>READ_COMMITTED：保证一个事务只能读取另一个事务已经提交的数据。可以防止脏读，但可能会导致不可重复读和幻读问题。</p>
<p>REPEATABLE_READ：保证一个事务在读取数据时不会看到其他事务对该数据的修改。可以防止脏读和不可重复读，但可能会导致幻读问题。</p>
<p>SERIALIZABLE：最高的隔离级别。保证事务按顺序执行，完全隔离。可以防止脏读、不可重复读和幻读问题，但并发性最低，可能导致性能下降。</p>
<h2 id="代码-Demo"><a href="#代码-Demo" class="headerlink" title="代码 Demo"></a>代码 Demo</h2><p>假设有一个服务类MyService，可以通过不同的隔离级别来配置事务：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class MyService &#123;</span><br><span class="line"></span><br><span class="line">    @Transactional(isolation = Isolation.READ_COMMITTED)</span><br><span class="line">    public void readCommittedMethod() &#123;</span><br><span class="line">        // 数据库操作</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Transactional(isolation = Isolation.REPEATABLE_READ)</span><br><span class="line">    public void repeatableReadMethod() &#123;</span><br><span class="line">        // 数据库操作</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Transactional(isolation = Isolation.SERIALIZABLE)</span><br><span class="line">    public void serializableMethod() &#123;</span><br><span class="line">        // 数据库操作</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="隔离级别的选择"><a href="#隔离级别的选择" class="headerlink" title="隔离级别的选择"></a>隔离级别的选择</h2><p>选择合适的隔离级别取决于具体的业务需求和对并发性和数据一致性的要求：</p>
<p><strong>READ_UNCOMMITTED</strong>：适用于对数据一致性要求不高，且需要最高并发性的场景。</p>
<p><strong>READ_COMMITTED</strong>：适用于大多数应用，能够防止脏读，提供较好的并发性和数据一致性平衡。</p>
<p><strong>REPEATABLE_READ</strong>：适用于需要防止脏读和不可重复读，但可以容忍幻读的场景。</p>
<p><strong>SERIALIZABLE</strong>：适用于对数据一致性要求极高的场景，尽管会牺牲并发性。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiaoyaofeihu.github.io/2025/03/05/Spring/Spring%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/11.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余声-个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/03/05/Spring/Spring%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA/" itemprop="url">👌Spring事务传播行为</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-03-05T13:33:41+00:00">
                2025-03-05
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2025-05-16T01:59:28+00:00">
                2025-05-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="👌Spring事务传播行为"><a href="#👌Spring事务传播行为" class="headerlink" title="👌Spring事务传播行为"></a>👌Spring事务传播行为</h1><h1 id="口语化回答"><a href="#口语化回答" class="headerlink" title="口语化回答"></a>口语化回答</h1><p>好的，面试官，传播行为主要有几种，REQUIRED，如果当前存在事务，则加入，否则创建一个新的。这是默认的事务传播行为。还有就是其他的不常用的事务形式，比如REQUIRES_NEW，总是创建一个新的事务。如果当前存在事务，则挂起当前事务。SUPPORTS总是创建一个新的事务。使用方式就是@Transactional 里面的propagation 属性进行直接指定即可。其他不常见的就不多提了，就是围绕有事务，无事务，嵌套，以及异常来分不同情况选择事务创建，以上。</p>
<h1 id="题目解析"><a href="#题目解析" class="headerlink" title="题目解析"></a>题目解析</h1><p>问的比较少，大家就记住前两种就 ok 了。如果全部理解的口诀，就是，有用，没有创建，异常建，没则抛异常。</p>
<h1 id="面试得分点"><a href="#面试得分点" class="headerlink" title="面试得分点"></a>面试得分点</h1><p>required，Transactional</p>
<h1 id="题目详细答案"><a href="#题目详细答案" class="headerlink" title="题目详细答案"></a>题目详细答案</h1><p>Spring 事务传播行为定义了在事务方法被调用时，事务如何传播。Spring 提供了多种传播行为，允许开发者定义事务的边界和行为。这些传播行为通过@Transactional注解的propagation属性来配置。</p>
<h2 id="传播行为类型"><a href="#传播行为类型" class="headerlink" title="传播行为类型"></a>传播行为类型</h2><p><strong>REQUIRED</strong>（默认值）：如果当前存在事务，则加入该事务；如果当前没有事务，则创建一个新的事务。</p>
<p><strong>REQUIRES_NEW：</strong>总是创建一个新的事务。如果当前存在事务，则挂起当前事务。</p>
<p><strong>SUPPORTS：</strong>如果当前存在事务，则加入该事务；如果当前没有事务，则以非事务方式继续执行。</p>
<p><strong>NOT_SUPPORTED：</strong>总是以非事务方式执行，如果当前存在事务，则挂起当前事务。</p>
<p><strong>MANDATORY：</strong>如果当前存在事务，则加入该事务；如果当前没有事务，则抛出异常。</p>
<p><strong>NEVER：</strong>总是以非事务方式执行，如果当前存在事务，则抛出异常。</p>
<p><strong>NESTED：</strong>如果当前存在事务，则在嵌套事务内执行；如果当前没有事务，则创建一个新的事务。</p>
<h2 id="代码-Demo"><a href="#代码-Demo" class="headerlink" title="代码 Demo"></a>代码 Demo</h2><p>假设有两个服务类ServiceA和ServiceB，可以通过不同的传播行为来控制事务的传播。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class ServiceA &#123;</span><br><span class="line">    </span><br><span class="line">    @Autowired</span><br><span class="line">    private ServiceB serviceB;</span><br><span class="line"></span><br><span class="line">    @Transactional(propagation = Propagation.REQUIRED)</span><br><span class="line">    public void methodA() &#123;</span><br><span class="line">        // Some database operations</span><br><span class="line">        serviceB.methodB();</span><br><span class="line">        // Some more database operations</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Service</span><br><span class="line">public class ServiceB &#123;</span><br><span class="line"></span><br><span class="line">    @Transactional(propagation = Propagation.REQUIRES_NEW)</span><br><span class="line">    public void methodB() &#123;</span><br><span class="line">        // Some database operations</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ServiceA的methodA方法使用REQUIRED传播行为，这意味着如果methodA被调用时没有事务存在，它将创建一个新的事务。如果methodA被调用时已经有一个事务存在，它将加入该事务。</p>
<p>ServiceB的methodB方法使用REQUIRES_NEW传播行为，这意味着它总是会创建一个新的事务。如果methodB被调用时已经有一个事务存在，该事务将被挂起，直到methodB的事务完成。</p>
<h2 id="事务传播行为的选择"><a href="#事务传播行为的选择" class="headerlink" title="事务传播行为的选择"></a>事务传播行为的选择</h2><p><strong>REQUIRED</strong>：大多数情况下使用的默认传播行为，适用于大多数需要事务管理的方法。</p>
<p><strong>REQUIRES_NEW</strong>：适用于需要独立事务的情况，例如记录日志、审计等操作，即使外层事务回滚，这些操作也应该提交。</p>
<p><strong>SUPPORTS</strong>：适用于可选事务的情况，例如读取操作，可以在事务内或事务外执行。</p>
<p><strong>NOT_SUPPORTED</strong>：适用于不需要事务的情况，例如调用外部服务。</p>
<p><strong>MANDATORY</strong>：适用于必须在事务内执行的方法，例如严格依赖事务上下文的操作。</p>
<p><strong>NEVER</strong>：适用于必须在非事务上下文中执行的方法。</p>
<p><strong>NESTED</strong>：适用于需要嵌套事务的情况，例如需要在一个事务内执行多个子事务，并且可以单独回滚子事务。	</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/6/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/11.jpg"
               alt="" />
          <p class="site-author-name" itemprop="name"></p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">225</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">javayun</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Gemini
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
