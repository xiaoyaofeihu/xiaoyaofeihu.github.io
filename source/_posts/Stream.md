---
title: Stream 
date: 2024-09-10 17:33:00
tags:
	- 并发
categories: 笔记
---

# Stream
### Stream API的深入理解

Stream API是Java 8中引入的一个关键抽象概念，它允许你以声明性方式处理数据集合（包括数组等）。Stream通过一系列的操作（如筛选、转换、聚合等）来构建复杂的数据处理流水线。

#### 特性及优点详解

1. **无存储**：Stream本身不存储数据，它只是数据源的一个视图。这意味着你可以对原始数据集合进行多次Stream操作，而不会改变原始数据。

2. **为函数式编程而生**：Stream API的设计符合函数式编程的范式，它鼓励使用不可变的数据和纯函数（即没有副作用的函数）。这使得代码更加简洁、易于理解和维护。

3. **惰式执行**：Stream上的操作是惰式执行的，这意味着只有在需要结果时才会执行操作。这有助于优化性能，因为它允许Stream API在可能的情况下延迟计算，直到真正需要结果为止。

4. **可消费性**：Stream只能被消费一次，一旦遍历过就会失效。这是为了保持流的不可变性，并防止在多个线程中同时修改流。

#### 关键性操作

- **流的创建**：可以通过集合的`stream()`或`parallelStream()`方法、`Stream.of()`方法或`Stream.Builder`来创建流。

- **中间操作**：这些操作会返回一个新的流，并允许你进行链式调用。常见的中间操作包括`filter()`（筛选）、`map()`（转换）、`flatMap()`（扁平化映射）、`sorted()`（排序）、`distinct()`（去重）等。

- **最终操作**：这些操作会触发流的计算，并返回一个结果或副作用。常见的最终操作包括`forEach()`（遍历）、`collect()`（收集到集合）、`reduce()`（归约）、`count()`（计数）等。

#### 示例分析

你给出的示例很好地展示了Stream API的使用场景。在这个示例中，你首先通过`filter()`筛选出非红色的球，然后通过`map()`将它们融化成随机的三角形，再通过另一个`filter()`筛选出非小的三角形，最后通过某种方式计算出剩余图形的周长。

这个示例展示了如何使用Stream API来构建一个复杂的数据处理流水线，并通过链式调用中间操作和最终操作来得到最终结果。

### 实际应用

Stream API在实际应用中非常有用，特别是在处理大型数据集时。它允许你以声明性方式编写代码，而不需要关心底层实现细节。此外，Stream API还支持并行处理，这使得它能够在多核处理器上更有效地利用计算资源。

总之，Stream API是Java 8中一个非常重要的特性，它极大地提高了Java程序员的生产力，并使得编写高效、简洁和易于维护的代码变得更加容易。