---
title: AtomicIntegerçš„å®žçŽ°æ–¹å¼åŠåœºæ™¯
date: 2024-11-12 13:33:41
tags:
	- å¹¶å‘
categories: é¢è¯•
---

# ðŸ‘ŒAtomicIntegerçš„å®žçŽ°æ–¹å¼åŠåœºæ™¯

# é¢˜ç›®è¯¦ç»†ç­”æ¡ˆ
AtomicIntegeræ˜¯ Java ä¸­æä¾›çš„ä¸€ç§ç”¨äºŽåœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹è¿›è¡ŒåŽŸå­æ“ä½œçš„ç±»ã€‚å®ƒå±žäºŽjava.util.concurrent.atomicåŒ…ï¼Œæä¾›äº†ä¸€ç§æ— é”çš„çº¿ç¨‹å®‰å…¨æ–¹å¼æ¥æ“ä½œæ•´æ•°å€¼ã€‚AtomicIntegeråŸºäºŽåº•å±‚çš„ç¡¬ä»¶åŽŸå­æ“ä½œï¼ˆä¾‹å¦‚ CAS æ“ä½œï¼‰å®žçŽ°ï¼Œç¡®ä¿åœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸­è¿›è¡Œé«˜æ•ˆçš„æ•°å€¼æ›´æ–°ã€‚

## AtomicIntegerçš„å®žçŽ°æ–¹å¼
AtomicIntegeré€šè¿‡ä½¿ç”¨ CASï¼ˆCompare-And-Swapï¼‰æ“ä½œæ¥å®žçŽ°åŽŸå­æ€§ã€‚CAS æ˜¯ä¸€ç§ç¡¬ä»¶çº§åˆ«çš„åŽŸå­æ“ä½œï¼Œèƒ½å¤Ÿç¡®ä¿åœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹å¯¹å˜é‡è¿›è¡Œæ— é”çš„æ›´æ–°ã€‚

1. **åº•å±‚å˜é‡**ï¼šä½¿ç”¨volatileå…³é”®å­—å£°æ˜Žä¸€ä¸ªintç±»åž‹çš„å˜é‡ï¼Œç¡®ä¿å˜é‡çš„å¯è§æ€§ã€‚
2. **CAS æ“ä½œ**ï¼šé€šè¿‡Unsafeç±»æä¾›çš„åŽŸå­æ“ä½œæ–¹æ³•æ¥å®žçŽ°æ— é”æ›´æ–°ã€‚

```plain
import java.util.concurrent.atomic.AtomicInteger;

public class AtomicIntegerExample {
    private final AtomicInteger atomicInteger = new AtomicInteger(0);

    public void increment() {
        atomicInteger.incrementAndGet();
    }

    public int getValue() {
        return atomicInteger.get();
    }

    public static void main(String[] args) {
        AtomicIntegerExample example = new AtomicIntegerExample();

        Runnable task = () -> {
            for (int i = 0; i < 1000; i++) {
                example.increment();
            }
        };

        Thread t1 = new Thread(task);
        Thread t2 = new Thread(task);

        t1.start();
        t2.start();

        try {
            t1.join();
            t2.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        System.out.println("Final value: " + example.getValue());
    }
}
```

åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨AtomicIntegerå®žçŽ°äº†ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ï¼Œå¹¶åœ¨ä¸¤ä¸ªçº¿ç¨‹ä¸­å¹¶å‘åœ°å¯¹è®¡æ•°å™¨è¿›è¡Œè‡ªå¢žæ“ä½œã€‚æœ€ç»ˆçš„ç»“æžœæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚

## AtomicIntegerçš„ä¸»è¦æ–¹æ³•
get(): èŽ·å–å½“å‰å€¼ã€‚

set(int newValue): è®¾ç½®å½“å‰å€¼ã€‚

getAndSet(int newValue): èŽ·å–å½“å‰å€¼ï¼Œå¹¶è®¾ç½®ä¸ºæ–°å€¼ã€‚

compareAndSet(int expect, int update): å¦‚æžœå½“å‰å€¼ç­‰äºŽé¢„æœŸå€¼ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸ºæ–°å€¼ã€‚

getAndIncrement(): èŽ·å–å½“å‰å€¼ï¼Œå¹¶è‡ªå¢žã€‚

incrementAndGet(): è‡ªå¢žï¼Œå¹¶èŽ·å–è‡ªå¢žåŽçš„å€¼ã€‚

getAndDecrement(): èŽ·å–å½“å‰å€¼ï¼Œå¹¶è‡ªå‡ã€‚

decrementAndGet(): è‡ªå‡ï¼Œå¹¶èŽ·å–è‡ªå‡åŽçš„å€¼ã€‚

getAndAdd(int delta): èŽ·å–å½“å‰å€¼ï¼Œå¹¶åŠ ä¸ŠæŒ‡å®šçš„å€¼ã€‚

addAndGet(int delta): åŠ ä¸ŠæŒ‡å®šçš„å€¼ï¼Œå¹¶èŽ·å–åŠ åŽçš„å€¼ã€‚

## ä½¿ç”¨åœºæ™¯
1. **è®¡æ•°å™¨**ï¼šåœ¨å¤šçº¿ç¨‹çŽ¯å¢ƒä¸­ç”¨äºŽè®¡æ•°ï¼Œä¾‹å¦‚ç»Ÿè®¡è¯·æ±‚æ•°ã€ç”¨æˆ·æ•°ç­‰ã€‚
2. **åºåˆ—ç”Ÿæˆå™¨**ï¼šç”Ÿæˆå…¨å±€å”¯ä¸€çš„åºåˆ—å·ã€‚
3. **å¹¶å‘æŽ§åˆ¶**ï¼šç”¨äºŽå®žçŽ°å¹¶å‘æŽ§åˆ¶æœºåˆ¶ï¼Œå¦‚é™æµå™¨ã€èµ„æºæ± ç­‰ã€‚
4. **çŠ¶æ€ç®¡ç†**ï¼šç”¨äºŽç®¡ç†å¤šçº¿ç¨‹çŽ¯å¢ƒä¸‹çš„å…±äº«çŠ¶æ€ï¼Œç¡®ä¿çŠ¶æ€æ›´æ–°çš„åŽŸå­æ€§ã€‚
5. **é”çš„æ›¿ä»£**ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨AtomicIntegeræ¥æ›¿ä»£ä¼ ç»Ÿçš„é”æœºåˆ¶ï¼Œå‡å°‘é”ç«žäº‰ï¼Œæé«˜æ€§èƒ½ã€‚

## ä¼˜ç¼ºç‚¹
#### ä¼˜ç‚¹
1. **é«˜æ•ˆ**ï¼šåŸºäºŽç¡¬ä»¶çº§åˆ«çš„åŽŸå­æ“ä½œï¼Œæ€§èƒ½é«˜äºŽä½¿ç”¨é”çš„æ–¹å¼ã€‚
2. **æ— é”**ï¼šé¿å…äº†é”ç«žäº‰å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå‡å°‘äº†å¼€é”€ã€‚
3. **ç®€å•æ˜“ç”¨**ï¼šæä¾›äº†ä¸°å¯Œçš„æ–¹æ³•ï¼Œç®€åŒ–äº†å¹¶å‘ç¼–ç¨‹ã€‚

#### ç¼ºç‚¹
1. **é€‚ç”¨èŒƒå›´æœ‰é™**ï¼šé€‚ç”¨äºŽç®€å•çš„æ•°å€¼æ›´æ–°æ“ä½œï¼Œå¯¹äºŽå¤æ‚çš„æ•°æ®ç»“æž„æˆ–æ“ä½œï¼Œä»éœ€è¦ä½¿ç”¨é”ã€‚
2. **CAS æ“ä½œå¤±è´¥é‡è¯•**ï¼šåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼ŒCAS æ“ä½œå¯èƒ½ä¼šé¢‘ç¹å¤±è´¥ï¼Œéœ€è¦å¤šæ¬¡é‡è¯•ï¼Œå½±å“æ€§èƒ½ã€‚



> åŽŸæ–‡: <https://www.yuque.com/jingdianjichi/xyxdsi/vpbqzzcb5t0ur8hm>